{"_filedata":{"slug":"nexmo-node-server-sdk-support-host-overriding-dr"},"title":"Nexmo&#8217;s Node.js Server SDK Added Support for Host Overriding","description":"","thumbnail":"https://www.nexmo.com/wp-content/uploads/2020/01/nodejs-sdk-update-2400x1200.png","author":154,"published":true,"published_at":"2020-01-17T18:14:46","tags":[360,1554,1150,697,1602],"body":"We’ve recently released [v2.6.0 of our Node.js SDK](https://www.npmjs.com/package/nexmo) and added the ability to change the host used for making the HTTP requests.\n\n## Why?\n\nThis feature allows you to override the default hosts, `api.nexmo.com` and `rest.nexmo.com`, in the SDK. One of the most common uses cases for this feature is bypassing the load balancer, and making the HTTP requests towards one of our location-specific Data Centres, for example, `api-sg-1.nexmo.com`.\n\nLet’s take a look at our [“Make an outbound call with an NCCO”](https://developer.nexmo.com/voice/voice-api/code-snippets/make-an-outbound-call-with-ncco/node) Code Snippet and change it to use the Singapore Data Centre when making the phone call.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">const Nexmo = require('nexmo') const nexmo = new Nexmo({ apiKey: NEXMO_API_KEY, apiSecret: NEXMO_API_SECRET, applicationId: NEXMO_APPLICATION_ID, privateKey: NEXMO_APPLICATION_PRIVATE_KEY_PATH }, { apiHost: 'api-sg-1.nexmo.com' }) nexmo.calls.create({ to: [{ type: 'phone', number: TO_NUMBER }], from: { type: 'phone', number: NEXMO_NUMBER }, ncco: [{ \"action\": \"talk\", \"text\": \"This is a text to speech call from Nexmo\" }] });</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fa504754720-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fa504754720-26\">26</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'nexmo'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-3\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Nexmo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_API_KEY</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiSecret</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_API_SECRET</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">applicationId</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_APPLICATION_ID</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-7\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">privateKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_APPLICATION_PRIVATE_KEY</span><span class=\"crayon-sy\">_</span>PATH</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-8\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-9\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiHost</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'api-sg-1.nexmo.com'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-10\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-11\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-12\"><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">calls</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">create</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-13\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">to</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'phone'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TO</span><span class=\"crayon-sy\">_</span>NUMBER</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-16\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-17\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">from</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'phone'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-19\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO</span><span class=\"crayon-sy\">_</span>NUMBER</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-20\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-21\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">ncco</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-22\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"action\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"talk\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-23\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"text\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"This is a text to speech call from Nexmo\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-24\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fa504754720-25\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fa504754720-26\">&nbsp;</div></div></td></tr></tbody></table>\n\nLooking closely, the only change we made to the code snippet was adding an options object in the `Nexmo` instance, with an `apiHost` property.\n\nAnother common use case for this feature is using a proxy or gateway to inspect your requests before they get passed on to the Nexmo API. Let’s use [curlhub](https://curlhub.io/) to inspect all our API traffic.\n\n[![](https://www.nexmo.com/wp-content/uploads/2020/01/curlhub.png)](https://www.nexmo.com/wp-content/uploads/2020/01/curlhub.png)\n\nAfter you sign up, curlhub gives you a `Bucket Id`. For example, `n43s3qc13thd`. That gets appended to any host you want to proxy. So if we want to proxy `api.nexmo.com`, the corresponding curlhub host is `api-nexmo-com-n43s3qc13thd.curlhub.io`. The same logic applies for `rest.nexmo.com`, and the corresponding curlhub host is `rest-nexmo-com-n43s3qc13thd.curlhub.io`.\n\nIn order to use those as the proxies for the requests our SDK makes, we’ll have to add the `apiHost` and `restHost` properties to our `new Nexmo` instance.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">const Nexmo = require('nexmo') const nexmo = new Nexmo({ apiKey: NEXMO_API_KEY, apiSecret: NEXMO_API_SECRET, applicationId: NEXMO_APPLICATION_ID, privateKey: NEXMO_APPLICATION_PRIVATE_KEY_PATH }, { apiHost: 'api-nexmo-com-n43s3qc13thd.curlhub.io', restHost: 'rest-nexmo-com-n43s3qc13thd.curlhub.io' })</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fe874610699-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fe874610699-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fe874610699-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fe874610699-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fe874610699-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fe874610699-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fe874610699-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fe874610699-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fe874610699-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fe874610699-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1be16fe874610699-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1be16fe874610699-12\">12</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fe874610699-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'nexmo'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fe874610699-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fe874610699-3\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Nexmo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fe874610699-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_API_KEY</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fe874610699-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiSecret</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_API_SECRET</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fe874610699-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">applicationId</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_APPLICATION_ID</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fe874610699-7\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">privateKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NEXMO_APPLICATION_PRIVATE_KEY</span><span class=\"crayon-sy\">_</span>PATH</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fe874610699-8\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fe874610699-9\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiHost</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'api-nexmo-com-n43s3qc13thd.curlhub.io'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fe874610699-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">restHost</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'rest-nexmo-com-n43s3qc13thd.curlhub.io'</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1be16fe874610699-11\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1be16fe874610699-12\">&nbsp;</div></div></td></tr></tbody></table>\n\n## What’s Next\n\nWe’re working on improving our Node.js SDK, and you can track our progress at [https://github.com/nexmo/nexmo-node](https://github.com/nexmo/nexmo-node). If you have any suggestions or issues, please feel free to raise them in GitHub or in our [community slack](https://developer.nexmo.com/community/slack)."}