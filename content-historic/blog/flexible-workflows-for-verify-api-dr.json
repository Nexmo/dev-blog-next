{"_filedata":{"slug":"flexible-workflows-for-verify-api-dr"},"title":"Flexible Workflows for Verify API","description":"","thumbnail":"https://www.nexmo.com/wp-content/uploads/2019/10/E_Flexible-Workflows_1200x600-1.jpg","author":247,"published":true,"published_at":"2019-10-02T08:00:01","tags":[89,206,1117],"body":"Nexmo’s [Verify API](https://developer.nexmo.com/verify/overview) is designed to allow you to confirm that a user has supplied a correct and valid phone number, by sending them a PIN code and asking them to input it.\n\nBy default this is done by first sending an SMS with the PIN code in it, and following this with a phone call with a spoken message containing the PIN. Finally, a second phone call is made in an attempt to reach the user.\n\nHaving this multi-step, multi-mode process really improves the success rates of verifying the user’s phone number. However we know that this isn’t the best possible workflow for every user so Verify API now has a new feature: Configurable Workflows.\n\n## Control the Verify Workflow\n\nFor each user you need to send a PIN code to, the “right” workflow might be different. That’s why Verify API now allows you to specify a `workflow_id` when you make the API call, allowing you to choose from any of five possible workflow patterns.\n\nThe additional parameter is added alongside the existing ones, so your API call looks something like this (in Node.js):\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">nexmo.verify.request({ number: RECIPIENT_NUMBER, brand: BRAND_NAME, workflow_id: WORKFLOW_ID }, (err, result) =&gt; { if (err) { console.error(err); } else { const verifyRequestId = result.request_id; console.log('request_id', verifyRequestId); } });</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1ff3c38524826564-13\">13</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1ff3c38524826564-1\"><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">verify</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">request</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1ff3c38524826564-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">RECIPIENT_NUMBER</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1ff3c38524826564-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">brand</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">BRAND_NAME</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1ff3c38524826564-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">workflow_id</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">WORKFLOW</span><span class=\"crayon-sy\">_</span>ID</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1ff3c38524826564-5\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">err</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">result</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1ff3c38524826564-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">err</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1ff3c38524826564-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">error</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">err</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1ff3c38524826564-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1ff3c38524826564-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">verifyRequestId</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">result</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">request_id</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1ff3c38524826564-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'request_id'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">verifyRequestId</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1ff3c38524826564-11\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1ff3c38524826564-12\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1ff3c38524826564-13\">&nbsp;</div></div></td></tr></tbody></table>\n\nYou will also find this [code snippet in other languages](https://developer.nexmo.com/verify/code-snippets/send-verify-request-with-workflow) on the Nexmo Developer Portal\n\nThe `workflow_id` can be any integer between 1 and 5, and here are the workflows that these numbers represent:\n\n### Workflow 1 (Default Workflow): SMS -> TTS -> TTS\n\nSend a PIN code by text message, follow up with two subsequent voice calls if the request wasn’t already verified. This is the default behaviour and probably a sound choice if you’re not sure which to pick.\n\n### Workflow 2: SMS -> SMS -> TTS\n\nSend a PIN code by text message, follow up with a second text message and finally a voice call if the request has not been verified. For geographies and/or users where SMS is preferable to a voice call.\n\n### Workflow 3: TTS -> TTS\n\nCall the user and speak a PIN code, follow up with a second call if the request wasn’t already verified. If you already know that a phone call works best for this user’s situation, a phone call with a retry is a good way to reach them.\n\n### Workflow 4: SMS -> SMS\n\nSend a PIN code by text message, follow up with a second text message if the code hasn’t been verified. Ideal for users that don’t like phone calls. Including, but not limited to, millenials.\n\n### Workflow 5: SMS -> TTS\n\nSend a PIN code by text message, follow up with a voice call if the code hasn’t been verified. Offering both text and speech but with only one attempt at each one includes lots of people without being too intrusive.\n\n## Make the Most of Your Reach\n\nAdjusting your application to make use of the best workflow for your use case (or even using different options for different customers) can really improve the verification rates of your customers.\n\nWe’re super excited to have this feature publicly available – let us know how you changed your workflows and why! You can always find us on Twitter [@NexmoDev](https://twitter.com/NexmoDev), email us [devrel@nexmo.com](mailto:devrel@nexmo.com) or ask a question in the `#verify-api` channel on the [Nexmo Community Slack](https://developer.nexmo.com/community/slack)."}