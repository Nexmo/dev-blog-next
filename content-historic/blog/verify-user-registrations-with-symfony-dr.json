{"_filedata":{"slug":"verify-user-registrations-with-symfony-dr"},"title":"Verify User Registrations with Symfony","description":"","thumbnail":"https://www.nexmo.com/wp-content/uploads/2020/04/Blog_Symfony_Verify_1200x600.png","author":367,"published":true,"published_at":"2020-04-20T16:53:59","tags":[200,1748,1747,1117],"body":"Users registering with false information can be a pest, which is especially the case when registering with phone numbers that you expect to be contactable. [Vonage’s Verify API](https://developer.nexmo.com/api/verify) provides a solution to this by enabling you to confirm that the phone number is correct and owned by the user. The API takes a phone number, sends a pin code to that phone number and expects it to be relayed back through the correct source.\n\nIn this tutorial, you’ll extend an existing basic user authentication system, built-in [Symfony 5](https://symfony.com/5), by implementing multi-factor authentication with the [Vonage Verify API](https://developer.nexmo.com/api/verify) ([Formerly Nexmo](https://twitter.com/VonageDev/status/1237835302200389633) Verify API).\n\nYou can find the finished code under the `end-tutorial` branch in this [GitHub repository](https://github.com/nexmo-community/verify-user-registrations-with-symfony).\n\n## Prerequisites\n\n*   [Docker](https://www.docker.com/)\n*   [Node Package Manager (NPM)](https://www.npmjs.com/get-npm)\n*   [A Vonage (formally Nexmo) account](https://dashboard.nexmo.com/sign-up?utm_source=DEV_REL&utm_medium=github&utm_campaign=https://github.com/nexmo-community/verify-user-registrations-with-symfony)\n*   [Git](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git)\n\n## Getting Started\n\n### Cloning the Repository\n\nClone the existing repository by copying this command into your Terminal, and then change directory into the project:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">git clone git@github.com:nexmo-community/verify-user-registrations-with-symfony.git cd verify-user-registrations-with-symfony</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5e0354092467-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5e0354092467-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5e0354092467-3\">3</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5e0354092467-1\"><span class=\"crayon-e\">git </span><span class=\"crayon-r\">clone</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">git</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">github</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">com</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">community</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">verify</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">registrations</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">with</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">symfony</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">git</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5e0354092467-2\"><span class=\"crayon-e\">cd </span><span class=\"crayon-v\">verify</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">registrations</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">with</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">symfony</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5e0354092467-3\">&nbsp;</div></div></td></tr></tbody></table>\n\n### Database Credentials\n\nWithin the `symfony/` directory create a `.env.local` file, to store your local environment variables you don’t wish to be committed to your repository. For example, your code needs to know the method and credentials to connect to your database. Copy the following line into your `.env.local` file:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">DATABASE_URL=postgresql://user:password@postgres:5432/test?serverVersion=11&amp;charset=utf8</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5e7917139190-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5e7917139190-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5e7917139190-1\"><span class=\"crayon-v\">DATABASE_URL</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">postgresql</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//user:password@postgres:5432/test?serverVersion=11&amp;charset=utf8</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5e7917139190-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe above example contains several pieces of information needed to connect to the database.\n\n*   `postgresql` is the protocol used to connect.\n*   `user` and `password` is the set of credentials used to authenticate to the database.\n*   `postgres` is the address for the domain.\n*   `5432` is the port to connect to the database.\n*   `test` is the database name.\n\n### Installing Third Party Libraries\n\nThere several third-party libraries already defined in this project need to be installed, both via Composer and yarn packages.\n\nRun the following three commands:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\"># Install libraries such as Symfony framework bundle and Doctrine Orm bundles (for manipulating the database). composer install # Install Symfony Webpack encore for integrating bootstrap and front end technologies into the Symfony application. yarn install # Compile front end files ready for development use. yarn run dev</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5e9523929915-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5e9523929915-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5e9523929915-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5e9523929915-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5e9523929915-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5e9523929915-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5e9523929915-7\">7</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5e9523929915-1\"><span class=\"crayon-p\"># Install libraries such as Symfony framework bundle and Doctrine Orm bundles (for manipulating the database).</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5e9523929915-2\"><span class=\"crayon-e\">composer </span><span class=\"crayon-v\">install</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5e9523929915-3\"><span class=\"crayon-p\"># Install Symfony Webpack encore for integrating bootstrap and front end technologies into the Symfony application.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5e9523929915-4\"><span class=\"crayon-e\">yarn </span><span class=\"crayon-v\">install</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5e9523929915-5\"><span class=\"crayon-p\"># Compile front end files ready for development use.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5e9523929915-6\"><span class=\"crayon-e\">yarn </span><span class=\"crayon-e\">run </span><span class=\"crayon-i\">dev</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5e9523929915-7\">&nbsp;</div></div></td></tr></tbody></table>\n\n### Running Docker\n\nFor this tutorial and to ensure that the server requirements are the same for everyone, a Docker config has been set up to use containers with predefined configurations.\n\nWithin the `docker/` directory run:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">docker-compose up -d</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ea460538565-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ea460538565-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ea460538565-1\"><span class=\"crayon-v\">docker</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">compose </span><span class=\"crayon-v\">up</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ea460538565-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nOnce the `docker-compose` command has finished, you should be able to see the following confirmation that the three containers are running:\n\n![Docker](https://www.nexmo.com/wp-content/uploads/2020/04/docker-up.png)\n\n### Running Database Migrations\n\nIn your terminal, connect to the PHP Docker container by running the following command:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">docker-compose exec php bash</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5eb147009097-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5eb147009097-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5eb147009097-1\"><span class=\"crayon-v\">docker</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">compose </span><span class=\"crayon-e\">exec </span><span class=\"crayon-e\">php </span><span class=\"crayon-i\">bash</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5eb147009097-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nTo create the database tables and execute all files found in symfony/src/migrations/, run the following command:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">php bin/console doctrine:migrations:migrate</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ec249057476-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ec249057476-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ec249057476-1\"><span class=\"crayon-e\">php </span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">console </span><span class=\"crayon-v\">doctrine</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">migrations</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">migrate</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ec249057476-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nThis command creates a user database table with the relevant columns.\n\n### Test Run the Registration\n\nGo to: `http://localhost:8081/register` in your browser, and you will see a registration page similar to what you see in the image below:\n\n![Initial registration page](https://www.nexmo.com/wp-content/uploads/2020/04/initial-register.png)\n\nEnter a test telephone number and password. On submission of the form, you should now see the profile page!\n\n> **_Note:_** Using your phone number here will create you a new user, so be ready to delete that registration from the user database table.\n\nIf you’re at this point, you’re all set up, and ready for this tutorial.\n\n## Installing Nexmo PHP SDK\n\n> **_Note:_** Composer commands are required to run from within the PHP docker container. From the **Running the Database Migrations** tutorial step, you remotely accessed the terminal for the PHP docker container. If you leave the container’s terminal session, you can get back to it by running `docker-compose exec php bash` from the `docker/` directory.\n\nThe tutorial uses Vonage Verify API. The easiest way to use this in PHP is to install our PHP SDK.\n\nTo install this run:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">composer require nexmo/client</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ee148069821-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ee148069821-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ee148069821-1\"><span class=\"crayon-e\">composer </span><span class=\"crayon-e\">require </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">client</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ee148069821-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nIn your [Vonage Developer Dashboard](https://dashboard.nexmo.com/getting-started-guide), you’ll find “Your API credentials”, make a note of these.\n\nWithin the directory `symfony/`, add the following two lines to your `.env.local` file (replacing the api\\_key and api\\_secret with your key and secret):\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">VONAGE_API_KEY=&lt;api_key&gt; VONAGE_API_SECRET=&lt;api_secret&gt;</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ef250611239-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ef250611239-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ef250611239-3\">3</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ef250611239-1\"><span class=\"crayon-v\">VONAGE_API_KEY</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">api_key</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ef250611239-2\"><span class=\"crayon-v\">VONAGE_API_SECRET</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">api_secret</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ef250611239-3\">&nbsp;</div></div></td></tr></tbody></table>\n\nCreate a new directory called `Util` inside `symfony/src/`, and within that directory create a new file called `VonageUtil.php`.\n\nThis Utility class will handle any code that uses the Nexmo PHP SDK. The example below will not do anything other than creating a NexmoClient object with the authentication credentials you’ve saved in `.env.local`. Copy the example below into your newly created `VonageUtil.php`:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">&lt;?php // symfony/src/Util/VonageUtil.php namespace App\\Util; use App\\Entity\\User; use Nexmo\\Client as NexmoClient; use Nexmo\\Client\\Credentials\\Basic; use Nexmo\\Verify\\Verification; class VonageUtil { /** @var NexmoClient */ protected $client; public function __construct() { $this-&gt;client = new NexmoClient( new Basic( $_ENV['VONAGE_API_KEY'], $_ENV['VONAGE_API_SECRET'] ) ); } }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f0349104685-27\">27</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-1\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-v\">php</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-3\"><span class=\"crayon-c\">// symfony/src/Util/VonageUtil.php</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-5\"><span class=\"crayon-t\">namespace</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">App</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Util</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-7\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">App</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Entity</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">User</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-8\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-e\">Client </span><span class=\"crayon-st\">as</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NexmoClient</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-9\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Client</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Credentials</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Basic</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-10\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Verify</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Verification</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-11\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-12\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">VonageUtil</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-13\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/** @var NexmoClient */</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">client</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-16\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">__construct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-19\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">client</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">NexmoClient</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Basic</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">_ENV</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'VONAGE_API_KEY'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-22\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">_ENV</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'VONAGE_API_SECRET'</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-23\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-24\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-25\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f0349104685-26\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f0349104685-27\">&nbsp;</div></div></td></tr></tbody></table>\n\n## Creating a Verification Page\n\n### Verify New Columns\n\nNew properties are needed inside the `User` entity to process verification of a new user correctly.\n\nWithin your Docker Terminal, type\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">php bin/console make:entity</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f1119052769-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f1119052769-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f1119052769-1\"><span class=\"crayon-e\">php </span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">console </span><span class=\"crayon-v\">make</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">entity</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f1119052769-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nYou’re going to create three new properties. So following the steps in the above command, enter the values as listed below:\n\nWhere it asks for an Entity type `User`\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">- New property name: countryCode - Type: string - Length: 2 - Is Nullable: false</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f2503981238-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f2503981238-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f2503981238-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f2503981238-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f2503981238-5\">5</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f2503981238-1\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">New</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">property</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">countryCode</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f2503981238-2\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f2503981238-3\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Length</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f2503981238-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">Is</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nullable</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f2503981238-5\">&nbsp;</div></div></td></tr></tbody></table>\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">- New property name: verificationRequestId - Type: string - Length: 255 - Is Nullable: true</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f3865769280-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f3865769280-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f3865769280-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f3865769280-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f3865769280-5\">5</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f3865769280-1\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">New</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">property</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">verificationRequestId</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f3865769280-2\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f3865769280-3\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Length</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">255</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f3865769280-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">Is</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nullable</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f3865769280-5\">&nbsp;</div></div></td></tr></tbody></table>\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">- New property name: verified - Type: boolean - Is Nullable: false</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f4246470779-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f4246470779-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f4246470779-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f4246470779-4\">4</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f4246470779-1\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">New</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">property</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">verified</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f4246470779-2\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">boolean</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f4246470779-3\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">Is</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nullable</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f4246470779-4\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe `countryCode` is needed to determine which country the phone number belongs to for the Verify API to make the call successfully.\n\nThe `verificationRequestId` the ID the Verify API initially returns to the server, which when paired with the verification code verifies the user.\n\nThe `verified` property allows the system to determine whether a user has verified or not.\n\nYou’ll need to run the following to generate a new migration file with these database changes.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">php bin/console make:migration</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f5932242805-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f5932242805-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f5932242805-1\"><span class=\"crayon-e\">php </span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">console </span><span class=\"crayon-v\">make</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">migration</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f5932242805-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe above command detects any changes made to the `Entity` files in your project. It then converts these changes into SQL queries which, when run as a migration, will persist the changes to your database.\n\nThe generated migration files are inside `symfony/src/Migrations` if you wish to see the upcoming database changes.\n\nIf you’re happy with these changes, run the command below to persist them to the database.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">php bin/console doctrine:migrations:migrate</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f6511259084-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f6511259084-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f6511259084-1\"><span class=\"crayon-e\">php </span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">console </span><span class=\"crayon-v\">doctrine</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">migrations</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">migrate</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f6511259084-2\">&nbsp;</div></div></td></tr></tbody></table>\n\n### Include Country Code in User Registration\n\nOpen your `RegistrationFormType` class in `symfony/src/Form/RegistrationFormType.php`. Add a new include for the ChoiceType class form type at the top of the file:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">use Symfony\\Component\\Form\\Extension\\Core\\Type\\ChoiceType;</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f7770673528-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f7770673528-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f7770673528-1\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Form</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Extension</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Core</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Type</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">ChoiceType</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f7770673528-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nIn the same file, make the following changes:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">public function buildForm(FormBuilderInterface $builder, array $options) { $builder + -&gt;add( + 'countryCode', + ChoiceType::class, + [ + 'label' =&gt; false, + 'attr' =&gt; [ + 'class' =&gt; 'form-control form-control-lg' + ], + 'choices' =&gt; [ + \"United Kingdom\" =&gt; \"GB\", + \"United States\" =&gt; \"US\" + ] + ] + )</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f8281825723-18\">18</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-1\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">buildForm</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">FormBuilderInterface</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">builder</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">array</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">options</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">builder</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-4\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-5\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'countryCode'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-6\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">ChoiceType</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">class</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-7\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-8\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'label'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-9\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'attr'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-10\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'class'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'form-control form-control-lg'</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-11\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-12\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'choices'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-13\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"United Kingdom\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"GB\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-14\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"United States\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"US\"</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-15\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-16\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f8281825723-17\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f8281825723-18\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe only two options to choose from, in this demo, are GB and the US. However, other countries are supported. You can find the ISO list of countries along with their accompanying country code here: [ISO.org](https://www.iso.org/obp/ui/#search). Please make sure that the value in the array is the two-character ISO standard for your country of choice.\n\nWithin `symfony/templates/registration/register.html.twig` you’ll find a form row for `phoneNumber`. Above this add the `countryCode` equivalent:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">+ {{ form_row(registrationForm.countryCode) }} {{ form_row(registrationForm.phoneNumber) }}</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f9791364462-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5f9791364462-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5f9791364462-3\">3</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f9791364462-1\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">form_row</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">registrationForm</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">countryCode</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5f9791364462-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">form_row</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">registrationForm</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">phoneNumber</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5f9791364462-3\">&nbsp;</div></div></td></tr></tbody></table>\n\nIf you have Docker running, you can check the registration page at [http://localhost:8081/register](http://localhost:8081/register/) and see a page similar to what’s shown below:\n\n![Registration page with country code](https://www.nexmo.com/wp-content/uploads/2020/04/register-form.png)\n\nYou’re welcome to use the registration form, but please do not use your number or be ready to delete that registration from the user database table.\n\n### Verify Phone Number Is Valid\n\nWhen calling a number to provide a verification code, the system requires a brand name. So in the `symfony/` directory, open `.env.local` and add a new line. Replacing `VerifyWithVonage` with whatever company/brand you’re representing for the verification:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">VONAGE_BRAND_NAME=VerifyWithVonage</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fc104944797-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fc104944797-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fc104944797-1\"><span class=\"crayon-v\">VONAGE_BRAND_NAME</span><span class=\"crayon-o\">=</span><span class=\"crayon-i\">VerifyWithVonage</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fc104944797-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nTo verify a number is a valid phone number, you need to check to make sure the phone number is in the correct format and is valid for the region (country code) you’ve provided. For this, you’re going to use [Giggsey’s PHP port of Google libphonenumber](https://packagist.org/packages/giggsey/libphonenumber-for-php).\n\nRun the command below to install this library.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">composer require giggsey/libphonenumber-for-php</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fd303191072-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fd303191072-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fd303191072-1\"><span class=\"crayon-e\">composer </span><span class=\"crayon-e\">require </span><span class=\"crayon-v\">giggsey</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">libphonenumber</span><span class=\"crayon-o\">-</span><span class=\"crayon-st\">for</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">php</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fd303191072-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nOpen your `VonageUtil` file, found in `symfony/src/Util`. Within this class, you need to add a method to validate the phone number and country code. This method also checks whether the phone number is a match for that region. If it is, the method will return the phone number in an internationalised format. Copy the following into this class:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">private function getInternationalizedNumber(User $user): ?string { $phoneNumberUtil = \\libphonenumber\\PhoneNumberUtil::getInstance(); $phoneNumberObject = $phoneNumberUtil-&gt;parse( $user-&gt;getPhoneNumber(), $user-&gt;getCountryCode() ); if (!$phoneNumberUtil-&gt;isValidNumberForRegion( $phoneNumberObject, $user-&gt;getCountryCode()) ) { return null; } return $phoneNumberUtil-&gt;format( $phoneNumberObject, \\libphonenumber\\PhoneNumberFormat::INTERNATIONAL ); }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5fe406577194-22\">22</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-1\"><span class=\"crayon-m\">private</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">getInternationalizedNumber</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">User</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">phoneNumberUtil</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">libphonenumber</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">PhoneNumberUtil</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">getInstance</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">phoneNumberObject</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">phoneNumberUtil</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">parse</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getPhoneNumber</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getCountryCode</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-9\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">!</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">phoneNumberUtil</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">isValidNumberForRegion</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">phoneNumberObject</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getCountryCode</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-16\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">phoneNumberUtil</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">format</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">phoneNumberObject</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-19\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">libphonenumber</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">PhoneNumberFormat</span><span class=\"crayon-o\">::</span><span class=\"crayon-i\">INTERNATIONAL</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5fe406577194-21\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5fe406577194-22\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe method uses the `$user` object to do the following:\n\n*   parse the phone number and country code using the `libphonenumber` library,\n*   checks that this is a valid number for the region provided (by country code).\n\nIf the number and region are valid, it formats the phone number into an internationalised one.\n\n## Sending a Verification Call on Registration\n\nCreate a method in `VonageUtil` that will make use of this private method. This new public method will ensure the user’s input is valid and using the Verify API, start the verification process.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">public function sendVerification(User $user) { // Retrieves the internationalized number using the previous util method created. $internationalizedNumber = $this-&gt;getInternationalizedNumber($user); // If the number is not valid or valid for the country code provided, then return null if (!$internationalizedNumber) { return null; } // Initialize the verification process with Vonage $verification = new Verification( $internationalizedNumber, $_ENV['VONAGE_BRAND_NAME'], ['workflow_id' =&gt; 3] ); return $this-&gt;client-&gt;verify()-&gt;start($verification); }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb5ff498921565-20\">20</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-1\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sendVerification</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">User</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// Retrieves the internationalized number using the previous util method created.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">internationalizedNumber</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getInternationalizedNumber</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-5\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// If the number is not valid or valid for the country code provided, then return null</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">!</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">internationalizedNumber</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// Initialize the verification process with Vonage</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Verification</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">internationalizedNumber</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">_ENV</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'VONAGE_BRAND_NAME'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'workflow_id'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-17\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">client</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">verify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">start</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb5ff498921565-19\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb5ff498921565-20\">&nbsp;</div></div></td></tr></tbody></table>\n\nTo save the jumping between different files, you’re going to add another method to this utility class. This new method will allow you to get the `request_id` which is returned within the `Verification` object when necessary.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">public function getRequestId(Verification $verification): ?string { $responseData = $verification-&gt;getResponseData(); if (empty($responseData)) { return null; } return $responseData['request_id']; }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb601763870872-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb601763870872-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb601763870872-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb601763870872-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb601763870872-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb601763870872-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb601763870872-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb601763870872-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb601763870872-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb601763870872-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb601763870872-11\">11</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb601763870872-1\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">getRequestId</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">Verification</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-t\">string</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb601763870872-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb601763870872-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">responseData</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getResponseData</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb601763870872-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb601763870872-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">empty</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">responseData</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb601763870872-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb601763870872-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb601763870872-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb601763870872-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">responseData</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'request_id'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb601763870872-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb601763870872-11\">&nbsp;</div></div></td></tr></tbody></table>\n\nThese new methods you’ve created inside the `VonageUtil` class don’t do anything right now. For them to be useful, you’ll need to call the functionality from within the `RegistrationController` so open this controller found within `symfony/src/Controller/`.\n\nFirst, you’ll need to inject the `VonageUtil` into the `RegistrationController` as a service:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">+use App\\Util\\VonageUtil; class RegistrationController extends AbstractController { + /** @var VonageUtil */ + protected $vonageUtil; + + public function __construct(VonageUtil $vonageUtil) + { + $this-&gt;vonageUtil = $vonageUtil; + }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb602662514356-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb602662514356-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb602662514356-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb602662514356-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb602662514356-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb602662514356-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb602662514356-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb602662514356-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb602662514356-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb602662514356-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb602662514356-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb602662514356-12\">12</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb602662514356-1\"><span class=\"crayon-o\">+</span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">App</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Util</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">VonageUtil</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb602662514356-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb602662514356-3\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RegistrationController</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">AbstractController</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb602662514356-4\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb602662514356-5\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">/** @var VonageUtil */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb602662514356-6\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">vonageUtil</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb602662514356-7\"><span class=\"crayon-o\">+</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb602662514356-8\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">__construct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">VonageUtil</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">vonageUtil</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb602662514356-9\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb602662514356-10\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">vonageUtil</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">vonageUtil</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb602662514356-11\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb602662514356-12\">&nbsp;</div></div></td></tr></tbody></table>\n\nWithin your `register` method find the three `$entityManager` lines and add functionality to `setVerified()` as false as shown below:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">+$user-&gt;setVerified(false); $entityManager = $this-&gt;getDoctrine()-&gt;getManager(); $entityManager-&gt;persist($user); $entityManager-&gt;flush();</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb603109383390-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb603109383390-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb603109383390-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb603109383390-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb603109383390-5\">5</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb603109383390-1\"><span class=\"crayon-o\">+</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">setVerified</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">false</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb603109383390-2\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">entityManager</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getDoctrine</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getManager</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb603109383390-3\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">entityManager</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">persist</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb603109383390-4\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">entityManager</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">flush</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb603109383390-5\">&nbsp;</div></div></td></tr></tbody></table>\n\nBelow `$entityManager->flush()` make the request to initiate the verification process. So, add the following two lines that first calls the `VonageUtil` method to send the verification request, the second line parses the response, and saves the `requestId` as a variable:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">$verification = $this-&gt;vonageUtil-&gt;sendVerification($user); $requestId = $this-&gt;vonageUtil-&gt;getRequestId($verification);</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb604047214594-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb604047214594-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb604047214594-3\">3</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb604047214594-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">vonageUtil</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">sendVerification</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb604047214594-2\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">requestId</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">vonageUtil</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getRequestId</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb604047214594-3\">&nbsp;</div></div></td></tr></tbody></table>\n\nIn the class find the following code:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">return $guardHandler-&gt;authenticateUserAndHandleSuccess( $user, $request, $authenticator, 'main' // firewall name in security.yaml );</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb605973030546-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb605973030546-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb605973030546-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb605973030546-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb605973030546-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb605973030546-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb605973030546-7\">7</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb605973030546-1\"><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">guardHandler</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">authenticateUserAndHandleSuccess</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb605973030546-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb605973030546-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb605973030546-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">authenticator</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb605973030546-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'main'</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// firewall name in security.yaml</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb605973030546-6\"><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb605973030546-7\">&nbsp;</div></div></td></tr></tbody></table>\n\nReplace this with functionality that first checks whether you’ve set the `requestId`, saves the `requestId` to the user, and then authenticates the user:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">if ($requestId) { $user-&gt;setVerificationRequestId($requestId); $entityManager-&gt;flush(); return $guardHandler-&gt;authenticateUserAndHandleSuccess( $user, $request, $authenticator, 'main' // firewall name in security.yaml ); }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb606367412813-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb606367412813-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb606367412813-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb606367412813-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb606367412813-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb606367412813-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb606367412813-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb606367412813-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb606367412813-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb606367412813-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb606367412813-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb606367412813-12\">12</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb606367412813-1\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">requestId</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb606367412813-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">setVerificationRequestId</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">requestId</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb606367412813-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">entityManager</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">flush</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb606367412813-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb606367412813-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">guardHandler</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">authenticateUserAndHandleSuccess</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb606367412813-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb606367412813-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb606367412813-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">authenticator</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb606367412813-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'main'</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">// firewall name in security.yaml</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb606367412813-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb606367412813-11\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb606367412813-12\">&nbsp;</div></div></td></tr></tbody></table>\n\n### Verify Form\n\nWithin your Docker Terminal, run the command below, and then follow the instructions entering the values as listed:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">php bin/console make:form</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb607587359269-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb607587359269-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb607587359269-1\"><span class=\"crayon-e\">php </span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">console </span><span class=\"crayon-v\">make</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">form</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb607587359269-2\">&nbsp;</div></div></td></tr></tbody></table>\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">- Name: VerifyFormType - Entity name: User</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb608211687881-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb608211687881-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb608211687881-3\">3</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb608211687881-1\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">VerifyFormType</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb608211687881-2\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Entity </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">User</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb608211687881-3\">&nbsp;</div></div></td></tr></tbody></table>\n\n![Creating a verify form in Symfony](https://www.nexmo.com/wp-content/uploads/2020/04/verify-form.png)\n\nBy submitting this, you should have a new class inside `symfony/src/Form/` called `VerifyFormType.php`. Some changes are needed for this form to work as expected:\n\nReplace the following lines:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">-&gt;add('phoneNumber') -&gt;add('roles') -&gt;add('password') -&gt;add('countryCode') -&gt;add('verificationRequestId') -&gt;add('verified')</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb609070913848-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb609070913848-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb609070913848-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb609070913848-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb609070913848-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb609070913848-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb609070913848-7\">7</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb609070913848-1\"><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'phoneNumber'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb609070913848-2\"><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'roles'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb609070913848-3\"><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'password'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb609070913848-4\"><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'countryCode'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb609070913848-5\"><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'verificationRequestId'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb609070913848-6\"><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'verified'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb609070913848-7\">&nbsp;</div></div></td></tr></tbody></table>\n\nwith:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">-&gt;add('verificationCode', TextType::class, [ 'mapped' =&gt; false, 'attr' =&gt; [ 'class' =&gt; 'form-control form-control-lg' ], 'constraints' =&gt; [ new NotBlank([ 'message' =&gt; 'Please enter a verification code', ]), new Length([ 'min' =&gt; 4, 'max' =&gt; 4, 'minMessage' =&gt; 'The verification code is a 4 digit number.', ]), ], ])</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60b521820669-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60b521820669-17\">17</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-1\"><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'verificationCode'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TextType</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">class</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'mapped'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'attr'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'class'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'form-control form-control-lg'</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'constraints'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">NotBlank</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'message'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'Please enter a verification code'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Length</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'min'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'max'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'minMessage'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'The verification code is a 4 digit number.'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60b521820669-16\"><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60b521820669-17\">&nbsp;</div></div></td></tr></tbody></table>\n\nYou’ve just removed form fields that shouldn’t be updated, added a new unmapped field (a field not mapped to the database table) called `verificationCode`. The `verificationCode` is sent to the API to verify the phone number.\n\nAt the top of the file, add three more includes. These are the fully qualified class names of classes used in the example code above.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">use Symfony\\Component\\Form\\Extension\\Core\\Type\\TextType; use Symfony\\Component\\Validator\\Constraints\\Length; use Symfony\\Component\\Validator\\Constraints\\NotBlank;</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60c550040557-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60c550040557-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60c550040557-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60c550040557-4\">4</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60c550040557-1\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Form</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Extension</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Core</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Type</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">TextType</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60c550040557-2\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Validator</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Constraints</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Length</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60c550040557-3\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Validator</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Constraints</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">NotBlank</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60c550040557-4\">&nbsp;</div></div></td></tr></tbody></table>\n\n## Verifying the Code\n\nIn your `VonageUtil` class, you need a new method to call the Vonage API to verify that the code provided by the user is valid. Put the example below into your `VonageUtil` class:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">public function verify(string $requestId, string $verificationCode) { $verification = new Verification($requestId); return $this-&gt;client-&gt;verify()-&gt;check($verification, $verificationCode); }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60d896467737-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60d896467737-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60d896467737-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60d896467737-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60d896467737-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60d896467737-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60d896467737-7\">7</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60d896467737-1\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">verify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">requestId</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verificationCode</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60d896467737-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60d896467737-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Verification</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">requestId</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60d896467737-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60d896467737-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">client</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">verify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">check</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verification</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verificationCode</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60d896467737-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60d896467737-7\">&nbsp;</div></div></td></tr></tbody></table>\n\nCreate a new template file inside `symfony/templates/registration` called `verify.html.twig`\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">{% extends 'base.html.twig' %} {% block title %}Verify{% endblock %} {% block body %} &lt;div class=\"row justify-content-center align-items-center h-100\"&gt; &lt;div class=\"col col-sm-6 col-md-6 col-lg-4 col-xl-3\"&gt; &lt;h1 class=\"h3 mb-3 font-weight-normal\"&gt;Verify&lt;/h1&gt; {{ form_start(verificationForm) }} &lt;div class=\"form-group\"&gt; {{ form_row(verificationForm.verificationCode) }} &lt;/div&gt; &lt;button class=\"btn btn-info btn-lg btn-block\" type=\"submit\"&gt;Verify&lt;/button&gt; {{ form_end(verificationForm) }} &lt;/div&gt; &lt;div&gt; {% endblock %}</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60e117853696-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60e117853696-20\">20</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-1\"><span class=\"crayon-sy\">{</span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">extends</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'base.html.twig'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-3\"><span class=\"crayon-sy\">{</span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">block </span><span class=\"crayon-v\">title</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-sy\">}</span><span class=\"crayon-e\">Verify</span><span class=\"crayon-sy\">{</span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">endblock</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-5\"><span class=\"crayon-sy\">{</span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">block </span><span class=\"crayon-v\">body</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">div </span><span class=\"crayon-t\">class</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"row justify-content-center align-items-center h-100\"</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">div </span><span class=\"crayon-t\">class</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"col col-sm-6 col-md-6 col-lg-4 col-xl-3\"</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">h1 </span><span class=\"crayon-t\">class</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"h3 mb-3 font-weight-normal\"</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">Verify</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">h1</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-9\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">form_start</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">verificationForm</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">div </span><span class=\"crayon-t\">class</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"form-group\"</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">form_row</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">verificationForm</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">verificationCode</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">div</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-14\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">button </span><span class=\"crayon-t\">class</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"btn btn-info btn-lg btn-block\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"submit\"</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-e\">Verify</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">button</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">form_end</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">verificationForm</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">div</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-e\">div</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60e117853696-19\"><span class=\"crayon-sy\">{</span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">endblock</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60e117853696-20\">&nbsp;</div></div></td></tr></tbody></table>\n\nInside your `RegistrationController` a new method is required to display the above template and handle the form submission.\n\nFirst, include the `VerifyFormType` and a Vonage class `Verification` at the top:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">use Symfony\\Component\\Routing\\Annotation\\Route; use Symfony\\Component\\Security\\Core\\Encoder\\UserPasswordEncoderInterface; use Symfony\\Component\\Security\\Guard\\GuardAuthenticatorHandler; +use App\\Form\\VerifyFormType; +use Nexmo\\Verify\\Verification;</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60f070759856-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60f070759856-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60f070759856-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60f070759856-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb60f070759856-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb60f070759856-6\">6</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60f070759856-1\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Routing</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Annotation</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Route</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60f070759856-2\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Security</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Core</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Encoder</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">UserPasswordEncoderInterface</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60f070759856-3\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Security</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Guard</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">GuardAuthenticatorHandler</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60f070759856-4\"><span class=\"crayon-o\">+</span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">App</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Form</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">VerifyFormType</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb60f070759856-5\"><span class=\"crayon-o\">+</span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Verify</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Verification</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb60f070759856-6\">&nbsp;</div></div></td></tr></tbody></table>\n\nThen, create the new method:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">/** * @Route(\"/register/verify\", name=\"app_register_verify\") */ public function verify(Request $request): Response { $user = $this-&gt;getUser(); $form = $this-&gt;createForm(VerifyFormType::class, $user); $form-&gt;handleRequest($request); if ($form-&gt;isSubmitted() &amp;&amp; $form-&gt;isValid()) { $verify = $this-&gt;vonageUtil-&gt;verify( $user-&gt;getVerificationRequestId(), $form-&gt;get('verificationCode')-&gt;getData() ); if ($verify instanceof Verification) { $user-&gt;setVerificationRequestId(null); $user-&gt;setVerified(true); $entityManager = $this-&gt;getDoctrine()-&gt;getManager(); $entityManager-&gt;flush(); return $this-&gt;redirectToRoute('profile'); } } return $this-&gt;render('registration/verify.html.twig', [ 'verificationForm' =&gt; $form-&gt;createView(), ]); }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb610366020881-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb610366020881-31\">31</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-1\"><span class=\"crayon-c\">/**</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-2\"><span class=\"crayon-c\">* @Route(\"/register/verify\", name=\"app_register_verify\")</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-3\"><span class=\"crayon-c\">*/</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-4\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">verify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">Request</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Response</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-5\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getUser</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">form</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">createForm</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">VerifyFormType</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">class</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">form</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">handleRequest</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-9\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">form</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">isSubmitted</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">form</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">isValid</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">verify</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">vonageUtil</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">verify</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getVerificationRequestId</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">form</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">get</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'verificationCode'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getData</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-15\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-e\">verify </span><span class=\"crayon-r\">instanceof</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Verification</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">setVerificationRequestId</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">null</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">setVerified</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">true</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-19\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">entityManager</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getDoctrine</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getManager</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">entityManager</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">flush</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-22\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-23\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">redirectToRoute</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'profile'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-24\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-25\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-26\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-27\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">render</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'registration/verify.html.twig'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-28\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'verificationForm'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">form</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">createView</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-29\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb610366020881-30\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb610366020881-31\">&nbsp;</div></div></td></tr></tbody></table>\n\nAt this point in the tutorial, the registration process is as follows:\n\n*   on `/register` enter a phone number and password\n*   a phone call is received quoting a four-digit number\n*   redirected to `/profile`\n\nThere is currently no checking to ensure the user is verified.\n\n## Enforcing Verification\n\nIn this step, you’re going to implement an event subscriber that checks for whether the user has verified before allowing them to access secured pages. If the user is not verified, they get redirected back to the verify form to input their verification code.\n\nIn your Docker Terminal, type the command to make a new event subscriber and follow the instructions in the screen with the following values:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">php bin/console make:subscriber</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb612302161782-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb612302161782-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb612302161782-1\"><span class=\"crayon-e\">php </span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">console </span><span class=\"crayon-v\">make</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">subscriber</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb612302161782-2\">&nbsp;</div></div></td></tr></tbody></table>\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">- Class name: `VerifiedUserSubscriber` - Event to subscribe to: `kernel.controller`</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb613178450928-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb613178450928-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb613178450928-3\">3</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb613178450928-1\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">Class</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">VerifiedUserSubscriber</span><span class=\"crayon-sy\">`</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb613178450928-2\"><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Event </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">subscribe </span><span class=\"crayon-st\">to</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">kernel</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">controller</span><span class=\"crayon-sy\">`</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb613178450928-3\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe image below shows an example of what is input to complete the command:\n\n![Verified user event subscriber](https://www.nexmo.com/wp-content/uploads/2020/04/verify-subscriber.png)\n\nOpen `VerifiedUserSubscriber` which can be found in `symfony/src/EventSubscriber/`.\n\nAdd the checks and restrictions to the onKernelController method.\n\nFirst you want to check whether the user is trying to access the profile URL or not. If they aren’t then return and allow them to proceed to their destination page:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">if (!preg_match('/^\\/profile/i', $event-&gt;getRequest()-&gt;getPathInfo())) { return; }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb614286386485-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb614286386485-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb614286386485-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb614286386485-4\">4</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb614286386485-1\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">!</span><span class=\"crayon-e\">preg_match</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'/^\\/profile/i'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">event</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getRequest</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getPathInfo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb614286386485-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb614286386485-3\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb614286386485-4\">&nbsp;</div></div></td></tr></tbody></table>\n\nYou now want to check whether the user has authenticated or not. To do this, inject the `tokenStorage` service into the event subscriber. While doing this, to save time, inject the `router` service for functionality after the user check.\n\nAt the top of the file along with the other class inclusions add the following:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">use Symfony\\Component\\Security\\Core\\Authentication\\Token\\Storage\\TokenStorageInterface; use Symfony\\Component\\HttpFoundation\\RedirectResponse; use Symfony\\Component\\Routing\\RouterInterface;</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb615838900258-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb615838900258-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb615838900258-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb615838900258-4\">4</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb615838900258-1\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Security</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Core</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Authentication</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Token</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Storage</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">TokenStorageInterface</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb615838900258-2\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">HttpFoundation</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">RedirectResponse</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb615838900258-3\"><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Symfony</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Component</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">Routing</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">RouterInterface</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb615838900258-4\">&nbsp;</div></div></td></tr></tbody></table>\n\nNext, inject the two services via the constructor of the class and set these services as properties within the class:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">/** @var RouterInterface */ protected $router; /** @var TokenStorageInterface */ private $tokenStorage; /** * @param RouterInterface $router * @param TokenStorageInterface $tokenStorage */ public function __construct( RouterInterface $router, TokenStorageInterface $tokenStorage ) { $this-&gt;router = $router; $this-&gt;tokenStorage = $tokenStorage; }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb616817612030-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb616817612030-18\">18</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-1\"><span class=\"crayon-c\">/** @var RouterInterface */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-2\"><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">router</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-3\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-4\"><span class=\"crayon-c\">/** @var TokenStorageInterface */</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-5\"><span class=\"crayon-m\">private</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">tokenStorage</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-7\"><span class=\"crayon-c\">/**</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-8\"><span class=\"crayon-c\">* @param RouterInterface $router</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-9\"><span class=\"crayon-c\">* @param TokenStorageInterface $tokenStorage</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-10\"><span class=\"crayon-c\">*/</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-11\"><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">__construct</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-i\">RouterInterface</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">router</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-i\">TokenStorageInterface</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-i\">tokenStorage</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-14\"><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">router</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">router</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">tokenStorage</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">tokenStorage</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb616817612030-17\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb616817612030-18\">&nbsp;</div></div></td></tr></tbody></table>\n\nBack within the `onKernelController` function, below the check for whether the user is accessing the profile or not, add the following, which checks whether the user has authenticated and whether they’re verified:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">if (null === $user = $this-&gt;tokenStorage-&gt;getToken()-&gt;getUser()) { return; } // Check whether the user is verified, if they are, allow them to continue to their destination. if ($user-&gt;getVerified()) { return; }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb617652393567-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb617652393567-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb617652393567-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb617652393567-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb617652393567-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb617652393567-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb617652393567-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb617652393567-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb617652393567-9\">9</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb617652393567-1\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">null</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">tokenStorage</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getToken</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getUser</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb617652393567-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb617652393567-3\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb617652393567-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb617652393567-5\"><span class=\"crayon-c\">// Check whether the user is verified, if they are, allow them to continue to their destination.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb617652393567-6\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">user</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">getVerified</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb617652393567-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb617652393567-8\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb617652393567-9\">&nbsp;</div></div></td></tr></tbody></table>\n\nFinally, if the user is at this point, they’re a logged-in user, they’re trying to access the profile section, and they’re not verified. So redirect them to the verify route to make sure they have to verify their account before proceeding.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">$route = $this-&gt;router-&gt;generate('app_register_verify'); $event-&gt;setController(function () use ($route) { return new RedirectResponse($route); });</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb618400299698-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb618400299698-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb618400299698-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc17eb618400299698-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc17eb618400299698-5\">5</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb618400299698-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">route</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">router</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">generate</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'app_register_verify'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb618400299698-2\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">event</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">setController</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">route</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb618400299698-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">RedirectResponse</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">route</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc17eb618400299698-4\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc17eb618400299698-5\">&nbsp;</div></div></td></tr></tbody></table>\n\n## Test It!\n\nThe full method of testing this tutorial now is to register a new account on [register](http://localhost:8081/register) with a valid phone number. You are taken to [verify](http://localhost:8081/register/verify) when you submit this form.\n\nThe phone number will receive a call quoting a four-digit code, which you’ll need to enter into the form on the verify page. Now [the profile](http://localhost:8081/profile) is accessible.\n\nYou’ve now integrated a two-step registration process into your Symfony application using the Vonage Verify API. The example provided is just one of many ways to use the Verify API. Whether it be via multi-factor authentication during login or verifying, a user’s phone number is valid to ensure they are contactable.\n\nIf this tutorial has piqued your interest in our Verify API, but PHP isn’t the language of your choice, other tutorials in various languages or services can be found here on the Vonage blog, such as:\n\n*   [Flexible Workflows for Verify API](https://www.nexmo.com/blog/2019/10/02/flexible-workflows-for-verify-api-dr)\n*   [Adding 2-Factor Authentication to WordPress with Nexmo Verify API](https://www.nexmo.com/blog/2019/10/09/adding-2-factor-authentication-to-wordpress-with-nexmo-verify-api-dr)\n*   [Verify Phone Numbers with Node-RED](https://www.nexmo.com/blog/2019/09/25/verify-phone-numbers-with-node-red-dr)\n*   [Building a Check-In App with Nexmo’s Verify API and Koa.js](https://www.nexmo.com/blog/2019/06/27/building-a-check-in-app-with-nexmos-verify-api-dr)\n\nThe finished code for this tutorial can be found on the [GitHub repository](https://github.com/nexmo-community/verify-user-registrations-with-symfony/tree/end-tutorial) in the end-tutorial branch."}