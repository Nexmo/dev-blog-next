{"_filedata":{"slug":"send-a-whatsapp-message-with-node-dr"},"title":"How to Send a WhatsApp Message with Node.js","description":"","thumbnail":"https://www.nexmo.com/wp-content/uploads/2020/04/Social_WhatsApp_Node-js_1200x627.png","author":304,"published":true,"published_at":"2020-04-15T12:06:53","tags":[1306,793,1743,754],"body":"<p>Traditionally, businesses contact customers by phone or SMS, but sometimes you really want to communicate with your customers via WhatsApp. The <a href=\"https://dashboard.nexmo.com/\">Vonage dashboard</a> now allows you to test out WhatsApp messaging without a WhatsApp business account. You can use the cURL command in the <a href=\"https://dashboard.nexmo.com/messages/sandbox\">Messages API Sandbox</a> to verify you&#8217;re able to send a message. Once you&#8217;ve tried that, you might like to see how you can incorporate WhatsApp messaging into your Node.js application.</p>\n<h2>Prerequisites</h2>\n<p>You can make use of the sandbox to test out your code without doing a lot of set up. Node already includes everything we need to make a POST request, and the Messages API does the rest. All you need is:</p>\n<ul>\n<li><a href=\"https://nodejs.org/\">Node</a></li>\n<li>A Vonage Developer account</li>\n<li>A whitelisted <a href=\"https://www.whatsapp.com/\">WhatsApp</a> number to test with</li>\n</ul>\n<h2>Setting up Your Sandbox</h2>\n<p>If you haven&#8217;t already, navigate to <a href=\"https://dashboard.nexmo.com/messages/sandbox\">Messages and Dispatch &gt; Sandbox</a> in your dashboard to set up your sandbox. The quickest way is to take your device with WhatsApp installed and center the camera on the QR code supplied. Sending the custom message generated will whitelist your number.</p>\n<p>You&#8217;ll see several additional options for joining the whitelist, including manually creating a message to the number supplied with a unique passphrase. If none of the others will work for your setup, that one should.</p>\n<p><img src=\"https://www.nexmo.com/wp-content/uploads/2020/04/whatsapp-whitelisting.jpeg\" alt=\"Sending a WhatsApp message to join the whitelist\" /></p>\n<h2>Creating Your Data</h2>\n<p>To make a call to the sandbox API you&#8217;ll need to supply a unique username, password, and to and from WhatsApp numbers. The username and password will be the two halves of the <code>u</code> argument in the cURL command from your dashboard. Copy the masked value, which will look like <code>12ab3456:123AbcdefghIJklM</code>. The part before the colon is your username and the part after is your password. They&#8217;re the same as your Vonage API key and secret, which are also available from <a href=\"https://dashboard.nexmo.com/getting-started-guide\">Getting Started</a> in the dashboard.</p>\n<p>You can also copy the data for your request straight from the cURL command and stringify it. It tells the API to send a text message from the sandbox number to your whitelisted number. You can change the text of the message to whatever you like, including generating it programmatically:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9b7992480e8215419132\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nvar user = '12ab3456';\nvar password = '123AbcdefghIJklM';\nvar from_number = '14151234567';\nvar to_number = '441234567890';\n\nconst data = JSON.stringify({\n  \"from\": { \"type\": \"whatsapp\", \"number\": from_number },\n  \"to\": { \"type\": \"whatsapp\", \"number\": to_number },\n  \"message\": {\n    \"content\": {\n      \"type\": \"text\",\n      \"text\": \"Hi! Your lucky number is \" + Math.floor(Math.random() * 100)\n    }\n  }\n});\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480e8215419132-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480e8215419132-16\">16</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-1\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">user</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'12ab3456'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-2\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">password</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'123AbcdefghIJklM'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-3\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">from_number</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'14151234567'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-4\"><span class=\"crayon-t\">var</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">to_number</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'441234567890'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-5\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-6\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">data</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">JSON</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">stringify</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-7\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-s\">\"from\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"whatsapp\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"number\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">from</span><span class=\"crayon-sy\">_</span>number<span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-s\">\"to\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"whatsapp\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"number\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">to</span><span class=\"crayon-sy\">_</span>number<span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-9\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-s\">\"message\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"content\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"text\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">\"text\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Hi! Your lucky number is \"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Math</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Math</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">random</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">100</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-14\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480e8215419132-15\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480e8215419132-16\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p></p>\n<h2>Creating a POST Request</h2>\n<p>The code to send a POST request with <a href=\"https://nodejs.org/api/https.html\">Node&#8217;s <code>https</code> module</a> is verbose, but it&#8217;s just listing the ordinary parts of an HTTP request. First you&#8217;ll require the module, then you&#8217;ll construct an object with the request options.</p>\n<p>Most of the options, like the <code>hostname</code>, <code>port</code>, and <code>method</code>, would be the same for any request to the sandbox API. All you&#8217;ll need to provide besides those are your authorization variables:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9b7992480ec734861704\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nconst https = require('https');\n\nconst options = {\n  hostname: 'messages-sandbox.nexmo.com',\n  port: 443,\n  path: '/v0.1/messages',\n  method: 'POST',\n  authorization: {\n    username: user,\n    password: password\n  },\n  headers: {\n    'Content-Type': 'application/json'\n  }\n};\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ec734861704-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ec734861704-16\">16</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">https</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'https'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-3\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">options</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">hostname</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'messages-sandbox.nexmo.com'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">port</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">443</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">path</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'/v0.1/messages'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-7\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">method</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'POST'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">authorization</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">username</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">user</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">password</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">password</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-11\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-12\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">headers</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-s\">'Content-Type'</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'application/json'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-14\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ec734861704-15\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ec734861704-16\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0002 seconds] -->\r\n<p></p>\n<h2>Making the Request</h2>\n<p>With your request options defined, you can go ahead and make the request using the <code>https</code> module&#8217;s <code>request</code> function. You&#8217;ll pass in your options and a callback, which gets any response to your request. The response contains an HTTP status code and you can listen for any additional data sent back, which should be a message UUID if everything works correctly.</p>\n<p>You can also create an error listener on the request itself.</p>\n<p>Once you&#8217;ve created your request, you can write your data object to the request. This tells the API to send the WhatsApp message. Then you can close the request and end your code:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9b7992480ed736911341\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nconst req = https.request(options, (res) =&gt; {\n  console.log(`statusCode: ${res.statusCode}`)\n\n  res.on('data', (d) =&gt; {\n    process.stdout.write(d)\n  })\n});\n\nreq.on('error', (e) =&gt; {\n  console.error(e);\n});\n\nreq.write(data);\nreq.end();\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ed736911341-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ed736911341-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ed736911341-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ed736911341-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ed736911341-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ed736911341-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ed736911341-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ed736911341-15\">15</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">req</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">https</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">request</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">options</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ed736911341-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">statusCode</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">statusCode</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-3\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ed736911341-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">on</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'data'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">d</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">process</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">stdout</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">write</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">d</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ed736911341-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-7\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ed736911341-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-9\"><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">on</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'error'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">e</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ed736911341-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">error</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">e</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-11\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ed736911341-12\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-13\"><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">write</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ed736911341-14\"><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">end</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9b7992480ed736911341-15\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p></p>\n<h2>Try It Out</h2>\n<p>Now you can save your code in a file called <code>app.js</code> and test it out. From the directory where the file is saved, run:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9b7992480ee022174821\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\n&gt; node app.js\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9b7992480ee022174821-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9b7992480ee022174821-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9b7992480ee022174821-1\"><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">node </span><span class=\"crayon-v\">app</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">js</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9b7992480ee022174821-2\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0001 seconds] -->\r\n<p></p>\n<p>Your test message should appear in WhatsApp on your whitelisted device.</p>\n<blockquote><p>\n  Troubleshooting: If your message was sent successfully and you received a 202 status but the message never showed up, your permissions may have expired. An easy fix is to send your whitelisting passphrase again. To understand more about WhatsApp policies and charges, check out the <a href=\"https://developer.nexmo.com/messages/concepts/whatsapp\">WhatsApp concepts</a> document.\n</p></blockquote>\n<p>You can find the <a href=\"https://github.com/nexmo-community/send-whatsapp-with-node/\">code for this example on Github</a>.</p>\n"}