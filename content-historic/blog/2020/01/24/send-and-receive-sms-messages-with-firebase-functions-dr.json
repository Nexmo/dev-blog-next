{"_filedata":{"slug":"send-and-receive-sms-messages-with-firebase-functions-dr"},"title":"Send and Receive SMS Messages with Firebase Functions","description":"","thumbnail":"https://www.nexmo.com/wp-content/uploads/2020/01/E_SMS-with-Firebase_1200x600.png","author":295,"published":true,"published_at":"2020-01-24T13:03:31","tags":[360,1111,92],"body":"<p>The Firebase platform allows developers to build an application backend rapidly. It&#8217;s also enjoyable to use as well. For this tutorial, I wanted to start using it for some SMS messaging with <a href=\"https://www.nexmo.com/\">Nexmo</a>. After this walk-through, you will be able to create an SMS message log, and a response to the sender using <a href=\"https://firebase.google.com/docs/functions/get-started\">Firebase Functions</a> and Firestore alongside the Nexmo SMS API.</p>\n<h2>Before You Get Started</h2>\n<p>You will need a few items to get going &#8211; so take a moment and make sure you have both of these ready to go.</p>\n<ol>\n<li><a href=\"https://firebase.google.com/\">Firebase</a></li>\n<li><a href=\"https://dashboard.nexmo.com/sign-in\">Nexmo</a></li>\n</ol>\n<h2>Setting up Firebase</h2>\n<p>The first step is to set up a Firebase project. The following will walk you through setting up a new project using the Firebase console.</p>\n<h3>Create the Firebase Project</h3>\n<ol>\n<li>Go to <a href=\"https://console.firebase.google.com/\">Firebase console</a> </li>\n<li>Click add project\n<p><img src=\"https://www.nexmo.com/wp-content/uploads/2020/01/create-project.png\" alt=\"Click Add Project\" /></p>\n</li>\n<li>\n<p>Add a name and click continue</p>\n<p><img src=\"https://www.nexmo.com/wp-content/uploads/2020/01/name-project.png\" alt=\"Name Project\" /></p>\n</li>\n<li>\n<p>Leave Google Analytics on and click continue (not required)</p>\n</li>\n<li>\n<p>Select a Google Analytics account and then click Create Project (if added)</p>\n<p><img src=\"https://www.nexmo.com/wp-content/uploads/2020/01/add-analytics.png\" alt=\"Add analytics\" /></p>\n</li>\n<li>\n<p>Wait a bit for the project to be created &#8211; takes less than a minute</p>\n</li>\n<li>Set the Billing type under <em>⚙️ -> Usage and Billing -> Details &amp; Settings</em> to Blaze. The Pay-as-you-go plan is required to use a third-party API. For more details regarding billing with Google, go <a href=\"https://cloud.google.com/billing/docs/how-to/payment-methods\">here</a>.<br />\n<img src=\"https://www.nexmo.com/wp-content/uploads/2020/01/update-billing.png\" alt=\"Change Billing\" /></li>\n<li>Set the <code>Google Cloud Platform (GCP) resource location</code> in <code>⚙️ -&gt; Project Settings</code><br />\n<img src=\"https://www.nexmo.com/wp-content/uploads/2020/01/update-location.png\" alt=\"Update Location\" /></li>\n</ol>\n<h3>Install Firebase Tools</h3>\n<p>Most everything you will need to do with Firebase can be done directly from the command line with the toolset they provide.</p>\n<ol>\n<li>Install the Firebase tools with npm<br />\n<code>npm install -g firebase-tools</code></li>\n<li>Log in to Firebase using <code>firebase login</code>. The login process will open your browser for authentication.</li>\n</ol>\n<h3>Setup Local Environment</h3>\n<p>Writing Firebase functions requires some initialization work to get started, but it&#8217;s mostly done for you using Firebase Tools commands.</p>\n<ol>\n<li>Create a project folder <code>mkdir nexmo-project &amp;&amp; cd nexmo-project</code></p>\n</li>\n<li>\n<p>Initialize Firebase Functions <code>firebase init functions</code></p>\n</li>\n</ol>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd0d441404207\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\n     ######## #### ########  ######## ########     ###     ######  ########\n     ##        ##  ##     ## ##       ##     ##  ##   ##  ##       ##\n     ######    ##  ########  ######   ########  #########  ######  ######\n     ##        ##  ##    ##  ##       ##     ## ##     ##       ## ##\n     ##       #### ##     ## ######## ########  ##     ##  ######  ########\n\nYou're about to initialize a Firebase project in this directory:\n\n /your_folders/your-project-name\n\n\n=== Project Setup\n\nFirst, let's associate this project directory with a Firebase project.\nYou can create multiple project aliases by running firebase use --add,\nbut for now, we'll just set up a default project.\n\n? Please select an option: (Use arrow keys)\n❯ Use an existing project\n Create a new project\n Add Firebase to an existing Google Cloud Platform project\n Don't set up a default project\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd0d441404207-23\">23</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-1\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=\"crayon-p\">######## #### ########&nbsp;&nbsp;######## ########&nbsp;&nbsp;&nbsp;&nbsp; ###&nbsp;&nbsp;&nbsp;&nbsp; ######&nbsp;&nbsp;########</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=\"crayon-p\">##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp; ## ##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp;##&nbsp;&nbsp; ##&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ##</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=\"crayon-p\">######&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;########&nbsp;&nbsp;######&nbsp;&nbsp; ########&nbsp;&nbsp;#########&nbsp;&nbsp;######&nbsp;&nbsp;######</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=\"crayon-p\">##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp;&nbsp;&nbsp; ## ##&nbsp;&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ## ##</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class=\"crayon-p\">##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #### ##&nbsp;&nbsp;&nbsp;&nbsp; ## ######## ########&nbsp;&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp; ##&nbsp;&nbsp;######&nbsp;&nbsp;########</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-7\"><span class=\"crayon-i\">You</span><span class=\"crayon-s\">'re about to initialize a Firebase project in this directory:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-9\"><span class=\"crayon-s\"> /your_folders/your-project-name</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-11\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-12\"><span class=\"crayon-s\">=== Project Setup</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-13\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-14\"><span class=\"crayon-s\">First, let'</span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">associate </span><span class=\"crayon-r\">this</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">project </span><span class=\"crayon-e\">directory </span><span class=\"crayon-i\">with</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Firebase </span><span class=\"crayon-v\">project</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-15\"><span class=\"crayon-e\">You </span><span class=\"crayon-e\">can </span><span class=\"crayon-e\">create </span><span class=\"crayon-e\">multiple </span><span class=\"crayon-e\">project </span><span class=\"crayon-e\">aliases </span><span class=\"crayon-e\">by </span><span class=\"crayon-e\">running </span><span class=\"crayon-e\">firebase </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">add</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-16\"><span class=\"crayon-e\">but </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">now</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">we</span><span class=\"crayon-s\">'ll just set up a default project.</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-17\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-18\"><span class=\"crayon-s\">? Please select an option: (Use arrow keys)</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-19\"><span class=\"crayon-s\">❯ Use an existing project</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-20\"><span class=\"crayon-s\"> Create a new project</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-21\"><span class=\"crayon-s\"> Add Firebase to an existing Google Cloud Platform project</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd0d441404207-22\"><span class=\"crayon-s\"> Don'</span><span class=\"crayon-i\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">set </span><span class=\"crayon-i\">up</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">default</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">project</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd0d441404207-23\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0002 seconds] -->\r\n<p></p>\n<p>Since you already created a project in the dashboard, you can select <code>Use an existing project</code> which will prompt you to choose the desired project. If you haven&#8217;t done this, use <code>Create a new project</code> and give it a unique name to create one. You would still need to go to the console to update the location and billing, but it is another option to create Firebase projects.</p>\n<ol>\n<li>Select the project name you created</li>\n<li>Select JavaScript</li>\n<li>Choose Y for ESLint if you desire (I recommend it)</li>\n<li>Install all dependencies now</li>\n</ol>\n<p>These steps will create the folders and files required to build Firebase Functions and installs all dependencies. Once NPM completes, switch to the <code>functions</code> directory and open <code>index.js</code> in your favorite editor to start adding code.</p>\n<h3>Create Your First Function</h3>\n<p>The first function you create will act as a webhook to capture and log incoming SMS messages from Nexmo.</p>\n<p>The <code>index.js</code> file has some example code provided you won&#8217;t need. Delete everything and start at the top to add the following code.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd11734432847\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nconst functions = require('firebase-functions');\nconst admin = require('firebase-admin'); \n\n// Initialize Firebase app for database access\nadmin.initializeApp();\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd11734432847-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd11734432847-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd11734432847-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd11734432847-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd11734432847-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd11734432847-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd11734432847-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'firebase-functions'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd11734432847-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">admin</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'firebase-admin'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd11734432847-3\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd11734432847-4\"><span class=\"crayon-c\">// Initialize Firebase app for database access</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd11734432847-5\"><span class=\"crayon-v\">admin</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">initializeApp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd11734432847-6\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0001 seconds] -->\r\n<p></p>\n<p>Calling <code>admin.initializeApp();</code> allows the functions to read and write to the Firebase Real-Time database. Next, use the following method to create your function.</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd12545294676\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\n// This function will serve as the webhook for incoming SMS messages,\n// and will log the message into the Firebase Realtime Database\nexports.inboundSMS = functions.https.onRequest(async (req, res) =&gt; {\n  await admin.database().ref('/msgq').push(req.body);\n  res.send(200);\n});\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd12545294676-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd12545294676-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd12545294676-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd12545294676-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd12545294676-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd12545294676-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd12545294676-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd12545294676-1\"><span class=\"crayon-c\">// This function will serve as the webhook for incoming SMS messages,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd12545294676-2\"><span class=\"crayon-c\">// and will log the message into the Firebase Realtime Database</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd12545294676-3\"><span class=\"crayon-v\">exports</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">inboundSMS</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">https</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">onRequest</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">async</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd12545294676-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">await </span><span class=\"crayon-v\">admin</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">database</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">ref</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'/msgq'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">push</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd12545294676-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">200</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd12545294676-6\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd12545294676-7\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0002 seconds] -->\r\n<p></p>\n<p>The <code>inboundSMS</code> method listens for HTTPS requests &#8211; which is precisely what Nexmo webhook needs. The Firebase Function will capture the <code>req.body</code> and send it to the <code>/msgq</code> object in the Real-Time Database as a log.</p>\n<p>Since we are using <code>req.body</code>, the webhook will need to be a <code>POST Method</code>. If you&#8217;d prefer to (or you have to) use the <code>GET</code> method for Nexmo webhooks, just replace it with <code>req.query</code>, and the GET method will work the same way.</p>\n<p>Now that you have some code written be sure to save your file an deploy the function to Firebase:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd13229221403\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nfirebase deploy --only functions\n\n=== Deploying to 'nexmo-project'...\n\ni deploying functions\nRunning command: npm --prefix \"$RESOURCE_DIR\" run lint\n\n&gt; functions@ lint /Users/kellyjandrews/Google Drive/Apps/nexmo-project/functions\n&gt; eslint .\n\n✔ functions: Finished running predeploy script.\ni functions: ensuring necessary APIs are enabled...\n✔ functions: all necessary APIs are enabled\ni functions: preparing functions directory for uploading...\ni functions: packaged functions (38.78 KB) for uploading\n✔ functions: functions folder uploaded successfully\ni functions: creating Node.js 8 function inboundSMS(us-central1)...\n✔ functions[inboundSMS(us-central1)]: Successful create operation.\nFunction URL (inboundSMS): https://us-central1-nexmo-project.cloudfunctions.net/inboundSMS\n\n✔ Deploy complete!\n\nProject Console: https://console.firebase.google.com/project/nexmo-project/overview\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd13229221403-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd13229221403-24\">24</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-1\"><span class=\"crayon-e\">firebase </span><span class=\"crayon-v\">deploy</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-e\">only </span><span class=\"crayon-v\">functions</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-3\"><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Deploying </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'nexmo-project'</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-5\"><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">deploying </span><span class=\"crayon-e\">functions</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-6\"><span class=\"crayon-e\">Running </span><span class=\"crayon-v\">command</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">npm</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">prefix</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"$RESOURCE_DIR\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">run </span><span class=\"crayon-v\">lint</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-7\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-8\"><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-sy\">@</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lint</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Users</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">kellyjandrews</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">Google </span><span class=\"crayon-v\">Drive</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">Apps</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">project</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">functions</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-9\"><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">eslint</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-11\">✔<span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Finished </span><span class=\"crayon-e\">running </span><span class=\"crayon-e\">predeploy </span><span class=\"crayon-v\">script</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-12\"><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ensuring </span><span class=\"crayon-e\">necessary </span><span class=\"crayon-e\">APIs </span><span class=\"crayon-e\">are </span><span class=\"crayon-v\">enabled</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-13\">✔<span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">all </span><span class=\"crayon-e\">necessary </span><span class=\"crayon-e\">APIs </span><span class=\"crayon-e\">are </span><span class=\"crayon-i\">enabled</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-14\"><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">preparing </span><span class=\"crayon-e\">functions </span><span class=\"crayon-e\">directory </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">uploading</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-15\"><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">packaged </span><span class=\"crayon-e\">functions</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">38.78</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">KB</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">uploading</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-16\">✔<span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">functions </span><span class=\"crayon-e\">folder </span><span class=\"crayon-e\">uploaded </span><span class=\"crayon-i\">successfully</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-17\"><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">creating </span><span class=\"crayon-v\">Node</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">js</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">8</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">inboundSMS</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">us</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">central1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-18\">✔<span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-sy\">[</span><span class=\"crayon-e\">inboundSMS</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">us</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">central1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">]</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Successful </span><span class=\"crayon-e\">create </span><span class=\"crayon-v\">operation</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-19\"><span class=\"crayon-t\">Function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">URL</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">inboundSMS</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">https</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//us-central1-nexmo-project.cloudfunctions.net/inboundSMS</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-20\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-21\">✔<span class=\"crayon-h\"> </span><span class=\"crayon-e\">Deploy </span><span class=\"crayon-v\">complete</span><span class=\"crayon-o\">!</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-22\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd13229221403-23\"><span class=\"crayon-e\">Project </span><span class=\"crayon-v\">Console</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">https</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//console.firebase.google.com/project/nexmo-project/overview</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd13229221403-24\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p></p>\n<p>The vital piece from the output is <code>Function URL (inboundSMS)</code>. This URL is required to set up the webhook in Nexmo, which you will do next.</p>\n<h2>Setting up Nexmo</h2>\n<p>There are a few quick steps to setting up Nexmo &#8211; all done from the command line.</p>\n<ol>\n<li>Install the CLI<br />\n<code>npm install -g nexmo-cli</code></li>\n<li>Setup the CLI with your API key and secret from the dashboard https://dashboard.nexmo.com/getting-started-guide</li>\n<li>Purchase a new phone number<br />\n<code>nexmo number:buy --country_code US</code></p>\n<ol>\n<li>This command retrieves the first available phone number in the US. For more info on Nexmo numbers, you can view the [numbers documentation](https://developer.nexmo.com/numbers/overview</li>\n<li>Type confirm, then copy the number</li>\n</ol>\n</li>\n<li>Link the phone number to the webhook using this command<br />\n<code>nexmo link:sms YOUR_NUMBER YOUR_FUNCTION_URL</code></li>\n</ol>\n<p>Give the process a few seconds to completely provision, then test out the new function to make sure the message is getting logged.</p>\n<p>Grab your phone and send a message to the phone number. Open up the Firebase console and navigate to <code>database</code> page, and you should see something like this:</p>\n<p><img src=\"https://www.nexmo.com/wp-content/uploads/2020/01/database-nexmo-object.png\" alt=\"Real-time Database Nexmo Message Entry\" /></p>\n<p>Now that there is a way to log incoming messages, you can write a function to do something with the incoming message.</p>\n<h2>Create the Send Function</h2>\n<p>So far, you have created a Firebase Function linked to a Nexmo phone number for capturing inbound SMS messages. Firebase Functions can also react to database updates. Upon a new entry, the code sends an echo of the original text.</p>\n<p>Start by adding Nexmo to the dependency list &#8211; make sure you do this in the <code>functions</code> directory:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd15202708218\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nnpm i nexmo --save\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd15202708218-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd15202708218-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd15202708218-1\"><span class=\"crayon-i\">npm</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">save</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd15202708218-2\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0001 seconds] -->\r\n<p></p>\n<p>Add the following environment variables to the Firebase config</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd17524110054\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nfirebase functions:config:set nexmo.api_key=\"YOUR_KEY\" nexmo.api_secret=\"YOUR_SECRET\"\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd17524110054-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd17524110054-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd17524110054-1\"><span class=\"crayon-e\">firebase </span><span class=\"crayon-v\">functions</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">config</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">set </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">api_key</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"YOUR_KEY\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">api_secret</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">\"YOUR_SECRET\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd17524110054-2\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0001 seconds] -->\r\n<p></p>\n<p>Next, open <code>index.js</code> add <code>nexmo</code> to the requirements at the top, and import the environment variables to initialize Nexmo:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd18885885256\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nconst functions = require('firebase-functions');\nconst admin = require('firebase-admin');\nconst Nexmo = require('nexmo');\n\n// Initialize Firebase app for database access\nadmin.initializeApp();\n\n// get Firebase environment variables for Nexmo\nconst {\n  api_key,\n  api_secret\n} = functions.config().nexmo;\n\n// Initialize Nexmo with application credentials\nconst nexmo = new Nexmo({\n  apiKey: api_key,\n  apiSecret: api_secret\n});\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd18885885256-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd18885885256-19\">19</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'firebase-functions'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">admin</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'firebase-admin'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-3\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'nexmo'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-4\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-5\"><span class=\"crayon-c\">// Initialize Firebase app for database access</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-6\"><span class=\"crayon-v\">admin</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">initializeApp</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-7\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-8\"><span class=\"crayon-c\">// get Firebase environment variables for Nexmo</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-9\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">api_key</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-11\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">api</span><span class=\"crayon-sy\">_</span>secret</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-12\"><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">config</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-13\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-14\"><span class=\"crayon-c\">// Initialize Nexmo with application credentials</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-15\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Nexmo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-16\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">api_key</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-17\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">apiSecret</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">api</span><span class=\"crayon-sy\">_</span>secret</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd18885885256-18\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd18885885256-19\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p></p>\n<p>Now you can create the new function for Firebase to send the response:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd19567490592\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\n// This function listens for updates to the Firebase Realtime Database\n// and sends a message back to the original sender\nexports.sendSMS = functions.database.ref('/msgq/{pushId}')\n  .onCreate((message) =&gt; {\n    const { msisdn, text, to } = message.val();\n    // the incoming object - 'msisdn' is the your phone number, and 'to' is the Nexmo number\n    // nexmo.message.sendSms(to, msisdn, text);\n    return nexmo.message.sendSms(to, msisdn, `You sent the following text: ${text}`, (err, res) =&gt; {\n      if (err) {\n        console.log(err);\n      } else {\n        if (res.messages[0]['status'] === \"0\") {\n          console.log(\"Message sent successfully.\");\n        } else {\n          console.log(`Message failed with error: ${res.messages[0]['error-text']}`);\n        }\n      }\n    })\n  });\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd19567490592-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd19567490592-20\">20</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-1\"><span class=\"crayon-c\">// This function listens for updates to the Firebase Realtime Database</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-2\"><span class=\"crayon-c\">// and sends a message back to the original sender</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-3\"><span class=\"crayon-v\">exports</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">sendSMS</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">functions</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">database</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">ref</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'/msgq/{pushId}'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">onCreate</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">msisdn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">text</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// the incoming object - 'msisdn' is the your phone number, and 'to' is the Nexmo number</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-c\">// nexmo.message.sendSms(to, msisdn, text);</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">sendSms</span><span class=\"crayon-sy\">(</span><span class=\"crayon-st\">to</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">msisdn</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-e\">You </span><span class=\"crayon-e\">sent </span><span class=\"crayon-e\">the </span><span class=\"crayon-e\">following </span><span class=\"crayon-v\">text</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">text</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">err</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">err</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">err</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">messages</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'status'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"0\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Message sent successfully.\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-e\">Message </span><span class=\"crayon-e\">failed </span><span class=\"crayon-e\">with </span><span class=\"crayon-v\">error</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">messages</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">'error-text'</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd19567490592-19\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd19567490592-20\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p></p>\n<p>The new function will watch for new messages added to the <code>/msgq</code> database object. When triggered, the full Nexmo object gets passed as <code>message</code> .  This object includes <code>msisdn</code>,  which is the originating phone number &#8211; yours in this case, and the <code>to</code> number, which is the Nexmo virtual number you purchased.</p>\n<p>With the phone numbers in hand, as well as the text message, you can now do any number of things. You can create a lookup table to respond with specific data based on the keyword, forward to another system, or in our case, send the original message.</p>\n<p>Deploy the Firebase Functions again from the command line:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd05dd1b542110202\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nfirebase deploy --only functions\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd05dd1b542110202-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd05dd1b542110202-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd05dd1b542110202-1\"><span class=\"crayon-e\">firebase </span><span class=\"crayon-v\">deploy</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-e\">only </span><span class=\"crayon-i\">functions</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd05dd1b542110202-2\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0001 seconds] -->\r\n<p></p>\n<p>Grab your phone, send another message, and then you should get a response back that looks something like <code>You sent the following text: Test message</code>.</p>\n<h2>Wrap Up</h2>\n<p>You have now completed all the steps for this tutorial. You can see the full code on <a href=\"https://github.com/nexmo-community/firebase-functions-sms-example\">Github</a>.</p>\n<p>Now that the initial steps to send and receive messages are complete, my next few posts will take this concept and expand it into controlling some of my home automation via text messages. I would love to hear what you plan to do as well so send me a message on <a href=\"https://twitter.com/kellyjandrews\">Twitter</a> and let me know.</p>\n<h2>Further Reading</h2>\n<ul>\n<li>Check out the Developer Documentation at <a href=\"https://developer.nexmo.com\">https://developer.nexmo.com</a></li>\n<li>Details about Nexmo SMS Functionality <a href=\"https://developer.nexmo.com/messaging/sms/overview\">https://developer.nexmo.com/messaging/sms/overview</a></li>\n<li>Getting started with Firebase Functions <a href=\"https://firebase.google.com/docs/functions/get-started\">https://firebase.google.com/docs/functions/get-started</a></li>\n</ul>\n"}