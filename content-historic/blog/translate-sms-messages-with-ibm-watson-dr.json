{"_filedata":{"slug":"translate-sms-messages-with-ibm-watson-dr"},"title":"Translate SMS Messages With IBM Watson","description":"","thumbnail":"https://www.nexmo.com/wp-content/uploads/2019/11/TW_EN_Translate-SMS_1200x675.png","author":295,"published":true,"published_at":"2019-11-12T15:18:17","tags":[1612,796,92,1644],"body":"In my previous posts, I showed how you can translate text messages with the [Google Translation API](https://www.nexmo.com/blog/2019/10/24/extending-nexmo-google-cloud-translation-api-dr) and [AWS Translate](https://www.nexmo.com/blog/2019/11/04/translating-sms-messages-with-aws-translate-dr).\n\n## Overview\n\nIn this post, I show you how to create an [inbound Nexmo SMS](https://developer.nexmo.com/messaging/sms/guides/inbound-sms) webhook and translate the message into English using the [IBM Watson Language Translator](https://www.ibm.com/watson/services/language-translator/).\n\nIn order to get started, you will need the following items setup:\n\n*   [IBM Cloud](https://cloud.ibm.com/login)\n*   [Nexmo Account](https://dashboard.nexmo.com/sign-up)\n*   [Nexmo CLI installed](https://github.com/Nexmo/nexmo-cli#installation)\n\n## Create Your Project\n\nThe setup for this example is minimal, and you only need a couple of packages to get going.\n\n*   [`ibm-watson`](https://www.npmjs.com/package/ibm-watson) – this is the official IBM Watson SDK\n*   [`express`](https://www.npmjs.com/package/express) – web framework to serve the webhook\n*   [`dotenv`](https://www.npmjs.com/package/dotenv) – a package to load environment variables\n*   [`body-parser`](https://www.npmjs.com/package/body-parser) – middleware for Express to handle the incoming webhook object\n\nInitialize the project and then install the above requirements using `npm` or `yarn`.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">npm init &amp;&amp; npm install ibm-watson express dotenv body-parser # or yarn init &amp;&amp; yarn add ibm-watson express dotenv body-parser</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb7e116829378-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb7e116829378-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb7e116829378-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb7e116829378-4\">4</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb7e116829378-1\"><span class=\"crayon-e\">npm </span><span class=\"crayon-v\">init</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npm </span><span class=\"crayon-e\">install </span><span class=\"crayon-v\">ibm</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">watson </span><span class=\"crayon-e\">express </span><span class=\"crayon-e\">dotenv </span><span class=\"crayon-v\">body</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">parser</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb7e116829378-2\"><span class=\"crayon-p\"># or</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb7e116829378-3\"><span class=\"crayon-e\">yarn </span><span class=\"crayon-v\">init</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">yarn </span><span class=\"crayon-e\">add </span><span class=\"crayon-v\">ibm</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">watson </span><span class=\"crayon-e\">express </span><span class=\"crayon-e\">dotenv </span><span class=\"crayon-v\">body</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">parser</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb7e116829378-4\">&nbsp;</div></div></td></tr></tbody></table>\n\nOnce installed, create an `index.js` and `.env` file.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">touch index.js .env</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb81990992971-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb81990992971-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb81990992971-1\"><span class=\"crayon-e\">touch </span><span class=\"crayon-v\">index</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">js</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">env</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb81990992971-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nNext, open the `index.js` file and put the following code inside:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">'use strict'; require('dotenv').config(); const express = require('express'); const bodyParser = require('body-parser'); const LanguageTranslatorV3 = require('ibm-watson/language-translator/v3'); const { IamAuthenticator } = require('ibm-watson/auth'); const app = express(); app.use(bodyParser.json()); app.use(bodyParser.urlencoded({ extended: true })); const server = app.listen(3000, () =&gt; { console.log(`Express server listening on port ${server.address().port} in ${app.settings.env} mode`); });</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb82838582571-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb82838582571-17\">17</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-1\"><span class=\"crayon-s\">'use strict'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-2\"><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'dotenv'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">config</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-3\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-4\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">express</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'express'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-5\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">bodyParser</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'body-parser'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-6\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">LanguageTranslatorV3</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'ibm-watson/language-translator/v3'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-7\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">IamAuthenticator</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'ibm-watson/auth'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-9\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">app</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">express</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-10\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-11\"><span class=\"crayon-v\">app</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">use</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">bodyParser</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">json</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-12\"><span class=\"crayon-v\">app</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">use</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">bodyParser</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">urlencoded</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">extended</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-13\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-14\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">server</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">app</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">listen</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">3000</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-15\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-e\">Express</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">server</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">listening</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">on</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">port</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">server</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">address</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">port</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">app</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">settings</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">env</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">mode</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb82838582571-16\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb82838582571-17\">&nbsp;</div></div></td></tr></tbody></table>\n\nThis will set up the server to run the example.\n\n### Installing Ngrok\n\nWebhooks need to be publicly available so that the Nexmo service can reach the application when incoming SMS messages are received. You could push your code up to a publicly available server, or you can use [`ngrok`](https://ngrok.com) to allow for public traffic to reach your local application.\n\nYou can learn more about installing `ngrok` with [this post](https://www.nexmo.com/blog/2017/07/04/local-development-nexmo-ngrok-tunnel-dr). After you have everything ready to go you can start ngrok using the following command to create your tunnel.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">ngrok http 3000</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb83402680896-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb83402680896-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb83402680896-1\"><span class=\"crayon-e\">ngrok </span><span class=\"crayon-i\">http</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3000</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb83402680896-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nMake a note of the `ngrok` address, as you will need that in a later step.\n\n## Setting Up IBM Watson Language Translator\n\nOnce you have the initial items set up, you can add IBM Watson Language Translator to your account and get the credentials required to run the example. Follow [this link](https://cloud.ibm.com/catalog/services/language-translator) to enable the Language Translator API. Select a project, and then click the `Enable` button to activate the API on that project.\n\n![Create IBM Watson Language Translator Service](https://www.nexmo.com/wp-content/uploads/2019/11/create_language_translator_service.png \"Create IBM Watson Language Translator Service\")\n\nOnce created you will be presented with a Getting Started tutorial. In the left nav, click `Manage` to locate following screen:\n\n![IBM Watson Language Translator Manage Screen](https://www.nexmo.com/wp-content/uploads/2019/11/language_translator_keys.png \"IBM Watson Language Translator Manage Screen\")\n\nOpen up the `.env` file first, and copy and paste the following:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">TRANSLATE_IAM_APIKEY= TRANSLATE_URL=</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb85225756633-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb85225756633-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb85225756633-3\">3</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb85225756633-1\"><span class=\"crayon-v\">TRANSLATE_IAM_APIKEY</span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb85225756633-2\"><span class=\"crayon-v\">TRANSLATE_URL</span><span class=\"crayon-o\">=</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb85225756633-3\">&nbsp;</div></div></td></tr></tbody></table>\n\nUsing the Copy the `API Key` and `URL` found on the IBM Watson Translation Manage page, fill in the `.env` file details, save and continue on to create the Nexmo phone number.\n\n## Setting Up Nexmo Inbound SMS Messages\n\nThis example requires a phone number from Nexmo to receive inbound messages. We can do this by using the [Nexmo CLI](https://github.com/Nexmo/nexmo-cli#installation) right from a terminal.\n\n### Purchase a Virtual Phone Number\n\nThe first step will be to purchase a number (feel free to use a different [ISO 3166 alpha-2](https://en.wikipedia.org/wiki/List_of_ISO_3166_country_codes) country code as needed).\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">nexmo number:buy --country_code US</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb86867025141-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb86867025141-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb86867025141-1\"><span class=\"crayon-e\">nexmo </span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">buy</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-e\">country_code </span><span class=\"crayon-i\">US</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb86867025141-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nAlthough the actual route to use in the application isn’t set up, you will name it `/message`. The phone number needs to be linked to this route so inbound messages know where to go. Get the `ngrok` host name from the previous setup and use it here:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">nexmo link:sms phone_number https://my-ngrok-hostname/message</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb87840226401-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb87840226401-2\">2</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb87840226401-1\"><span class=\"crayon-e\">nexmo </span><span class=\"crayon-v\">link</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">sms </span><span class=\"crayon-e\">phone_number </span><span class=\"crayon-v\">https</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//my-ngrok-hostname/message</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb87840226401-2\">&nbsp;</div></div></td></tr></tbody></table>\n\nNow we have the Nexmo webhook setup as a place for inbound SMS messages to be routed.\n\n## Finish the Application\n\nAll that is left for this tutorial is creating the Express route to handle the incoming data and a couple of small functions to actually perform the translation.\n\n### Build the Webhook\n\nFirst, we need to build the webhook code. Nexmo has a built in feature for setting default SMS behaviour. [In the settings panel](https://dashboard.nexmo.com/settings) you can change the default `HTTP` method used. Mine is set to `POST-JSON`. I would recommend using this setting if possible, however the code used in this example will handle all three options in case you are unable to modify this setting.\n\n![Default Nexmo SMS HTTP Method](https://www.nexmo.com/wp-content/uploads/2019/10/default-sms-settings.png \"Default Nexmo SMS HTTP Method\")\n\nOpen up the `index.js` file, and at the bottom, paste the following code:\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">// Reading the inbound SMS messages const handleRoute = (req, res) =&gt; { let params = req.body; if (req.method === \"GET\") { params = req.query } if (!params.to || !params.msisdn) { res.status(400).send({'error': 'This is not a valid inbound SMS message!'}); } else { translateText(params); res.status(200).end(); } };</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb88780413526-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb88780413526-18\">18</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-1\"><span class=\"crayon-c\">// Reading the inbound SMS messages</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">handleRoute</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-3\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-e\">let </span><span class=\"crayon-v\">params</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-5\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">method</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">===</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"GET\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">params</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">query</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-9\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-o\">!</span><span class=\"crayon-v\">params</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">!</span><span class=\"crayon-v\">params</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">msisdn</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">status</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">400</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">'error'</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'This is not a valid inbound SMS message!'</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-12\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-e\">translateText</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">params</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">status</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">200</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">end</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-15\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-16\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb88780413526-17\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb88780413526-18\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe above snippet is the method we will pass into the routes. If the incoming message is using `POST` it will use `req.body`, and it will use `req.query` for the `GET` option. As long as the inbound payload is properly set up, the object will be sent along to the `translateText` method to display the translation.\n\nNow you can add the route and proper `HTTP` methods to the application.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">app.route('/message') .get(handleRoute) .post(handleRoute) .all((req, res) =&gt; res.status(405).send());</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8a821789309-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8a821789309-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8a821789309-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8a821789309-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8a821789309-5\">5</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8a821789309-1\"><span class=\"crayon-v\">app</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">route</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'/message'</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8a821789309-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">get</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">handleRoute</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8a821789309-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">post</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">handleRoute</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8a821789309-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">all</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">req</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">res</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">status</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">405</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8a821789309-5\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe above code will create the `GET` and `POST` methods to handle either from the inbound SMS webhook message. If any other method is used, a `405 - Method Not Allowed` response will be returned.\n\nThe webhook is ready to go and the final piece is the actual translations.\n\n### Translation Method\n\nIn the previous step we call `translateText`. This step will create that method.\n\nUsing the `ibm-watson` package we first instantiate the `LanguageTranslatorV3` class, which will give us the `translate` method. This is called within the `translateText` method and uses the `text` field from the inbound SMS message object. The `modelId` input is any two-letter code for the [language to translate into](https://cloud.ibm.com/docs/services/language-translator?topic=language-translator-translation-models).\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">const languageTranslator = new LanguageTranslatorV3({ version: '2017-09-21', authenticator: new IamAuthenticator({ apikey: process.env.TRANSLATE_IAM_APIKEY, }), url: process.env.TRANSLATE_URL, }); function translateText(params) { const translateParams = { text: params.text, modelId: 'en-es', }; languageTranslator.translate(translateParams) .then(data =&gt; { console.log(`Original Text ${params.text}`); console.dir(`Translation ${data.result.translations[0].translation}`) }) .catch(err =&gt; { console.log('error:', err); }); }</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8b470665488-24\">24</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">languageTranslator</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LanguageTranslatorV3</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-2\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">version</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'2017-09-21'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-3\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">authenticator</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">IamAuthenticator</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">apikey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">process</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">env</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">TRANSLATE_IAM_APIKEY</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">url</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">process</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">env</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">TRANSLATE_URL</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-7\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-9\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">translateText</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">params</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-10\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">translateParams</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">text</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">params</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">text</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">modelId</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'en-es'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-13\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-14\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-15\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">languageTranslator</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">translate</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">translateParams</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">then</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-e\">Original</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Text</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">params</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">text</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">dir</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-e\">Translation</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">data</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">result</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">translations</span><span class=\"crayon-sy\">[</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">translation</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-19\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">catch</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">err</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'error:'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">err</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-22\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8b470665488-23\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8b470665488-24\">&nbsp;</div></div></td></tr></tbody></table>\n\nNow you can test out the functionality by starting the server, and sending a text message to the number you purchased earlier.\n\n<textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly=\"\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">node index.js # Text \"Hola\" to your phone number # expected response Original Text: Hola Translation: Hello</textarea>\n\n<table class=\"crayon-table\"><tbody><tr class=\"crayon-row\"><td class=\"crayon-nums \" data-settings=\"show\"><div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8c764146965-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8c764146965-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8c764146965-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8c764146965-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8c764146965-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9ddc1fefb8c764146965-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9ddc1fefb8c764146965-7\">7</div></div></td><td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8c764146965-1\"><span class=\"crayon-e\">node </span><span class=\"crayon-v\">index</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">js</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8c764146965-2\"><span class=\"crayon-p\"># Text \"Hola\" to your phone number</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8c764146965-3\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8c764146965-4\"><span class=\"crayon-p\"># expected response</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8c764146965-5\"><span class=\"crayon-e\">Original </span><span class=\"crayon-v\">Text</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Hola</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9ddc1fefb8c764146965-6\"><span class=\"crayon-v\">Translation</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Hello</span></div><div class=\"crayon-line\" id=\"crayon-5e9ddc1fefb8c764146965-7\">&nbsp;</div></div></td></tr></tbody></table>\n\nThe IBM Watson Language Translator full response object has a lot of details as well, so you could change the response to include `console.dir(translationResult, {depth: null})` to see the full payload.\n\n## Recap\n\nThe example above is just a small introduction to translation using the IBM Watson Translation service. From here you can translate the inbound message, and then translate the outbound message into the correct language as well (future blog post, for sure).\n\nYou can find a completed version of this tutorial on the [Nexmo Community GitHub](https://github.com/nexmo-community/sms-translate-ibm-js).\n\nIf you want to learn more about the Extend projects we have, you can visit [https://developer.nexmo.com/extend](https://developer.nexmo.com/extend)."}