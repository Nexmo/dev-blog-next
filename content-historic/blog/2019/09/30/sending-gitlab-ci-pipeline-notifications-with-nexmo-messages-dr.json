{"_filedata":{"slug":"sending-gitlab-ci-pipeline-notifications-with-nexmo-messages-dr"},"title":"Sending GitLab CI Pipeline Notifications with Nexmo Messages","description":"","thumbnail":"https://www.nexmo.com/wp-content/uploads/2019/09/E_GitLab-CI-Pipeline_1200x600.jpg","author":348,"published":true,"published_at":"2019-09-30T08:00:36","tags":[119,1621,1333,1550],"body":"<p><a href=\"https://developer.nexmo.com/spotlight\" target=\"_blank\" rel=\"noopener noreferrer\"><img src=\"https://www.nexmo.com/wp-content/uploads/2019/08/blog-spotlight-banner.png\" alt=\"blog spotlight banner \" width=\"810\" height=\"150\" class=\"alignnone size-full wp-image-29837\" /></a></p>\n<p>I operate my own blog, <a href=\"https://www.thepolyglotdeveloper.com\">The Polyglot Developer</a>, which publishes as part of a continuous integration and continuous deployment pipeline. Essentially, the following series of events happens every time a <code>git push</code> is done:</p>\n<ol>\n<li>The static site is pushed to GitLab</li>\n<li>The build process of the pipeline starts</li>\n<li>The deploy process of the pipeline starts</li>\n<li>The static site is published and is ready for consumption</li>\n</ol>\n<p>In more circumstances than I&#8217;d like to admit, the process fails because either my build failed or the deploy failed. The thing is, I don&#8217;t often know that these failures happen, which sometimes causes a lot of back-tracking.</p>\n<p>We&#8217;re going to see how to improve the CI / CD process by including SMS notifications powered by Nexmo in the event of a failure.</p>\n<h2>Understanding the GitLab CI Configuration and Process</h2>\n<p>In case you&#8217;re unfamiliar with GitLab, you can make use of their CI services by including a <strong>.gitlab-ci.yml</strong> file at the root of your Git project. This file might look something like this:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd560948787844455\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nimage: \"node:alpine\"\n\nstages:\n  - build\n  - deploy\n\nbuild:\n  stage: build\n  script: \n    - npm install\n    - npx gulp build\n    artifacts:\n      paths:\n        - dist\n\ndeploy:\n  stage: deploy\n  script:\n    - npm install\n    - npx gulp deploy\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560948787844455-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560948787844455-21\">21</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-1\"><span class=\"crayon-v\">image</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"node:alpine\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-3\"><span class=\"crayon-v\">stages</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">deploy</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-7\"><span class=\"crayon-v\">build</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-9\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npm </span><span class=\"crayon-v\">install</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npx </span><span class=\"crayon-e\">gulp </span><span class=\"crayon-e\">build</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-12\"><span class=\"crayon-e\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">artifacts</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">paths</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dist</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-15\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-16\"><span class=\"crayon-v\">deploy</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-17\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">deploy</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-18\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-19\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npm </span><span class=\"crayon-v\">install</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560948787844455-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npx </span><span class=\"crayon-e\">gulp </span><span class=\"crayon-i\">deploy</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560948787844455-21\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p></p>\n<p>The above configuration is fictional, but it follows a correctly formatted <strong>.gitlab-ci.yml</strong> file. In the above scenario, there is a <code>build</code> stage which runs the <code>build</code> gulp task and a <code>deploy</code> stage which runs the <code>deploy</code> gulp task.</p>\n<p>If either of the two stages fails, what happens?</p>\n<p>With GitLab CI you&#8217;re able to define when certain stages run which means you can design a stage to run when there is a failure. With this in mind, we could update our <strong>.gitlab-ci.yml</strong> to look something like the following:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd56094c207319195\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nimage: \"node:alpine\"\n\nstages:\n  - build\n  - deploy\n  - failure\n\nbuild:\n  stage: build\n  script: \n    - npm install\n    - npx gulp build\n    artifacts:\n      paths:\n        - dist\n\ndeploy:\n  stage: deploy\n  script:\n    - npm install\n    - npx gulp deploy\n\nfailure:\n  stage: failure\n  script:\n    - echo \"failure\"\n  when: on_failure\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094c207319195-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094c207319195-28\">28</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-1\"><span class=\"crayon-v\">image</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"node:alpine\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-3\"><span class=\"crayon-v\">stages</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">deploy</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-6\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">failure</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-7\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-8\"><span class=\"crayon-v\">build</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-9\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">build</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-10\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npm </span><span class=\"crayon-v\">install</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npx </span><span class=\"crayon-e\">gulp </span><span class=\"crayon-e\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-13\"><span class=\"crayon-e\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">artifacts</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">paths</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dist</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-16\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-17\"><span class=\"crayon-v\">deploy</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-18\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">deploy</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-19\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-20\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npm </span><span class=\"crayon-v\">install</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-21\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">npx </span><span class=\"crayon-e\">gulp </span><span class=\"crayon-e\">deploy</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-22\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-23\"><span class=\"crayon-v\">failure</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-24\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">failure</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-25\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-26\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"failure\"</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094c207319195-27\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">when</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">on</span><span class=\"crayon-sy\">_</span>failure</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094c207319195-28\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p></p>\n<p>The important piece of information is the <code>when</code> property that exists on the <code>failure</code> stage.</p>\n<p>So now that we know how to create a GitLab CI configuration, how do we use that to our advantage for notifying us whenever there is a failure in the pipeline?</p>\n<p>This is where Nexmo and the SMS service is valuable.</p>\n<h2>Using the Nexmo SMS API</h2>\n<p>When our pipeline fails, we can make use of the SMS service from Nexmo to send us a text message which might include pipeline information, commit information, or really anything that might be valuable to us or the team responsible for the project.</p>\n<p>To use the Nexmo SMS API, <a href=\"https://developer.nexmo.com?utm_campaign=dev_spotlight&amp;utm_content=gitlab_pipeline_raboy\">you&#8217;ll need an account</a>. Within the <strong>Settings</strong> section of your account, take note of the API key and the API secret.</p>\n<p><a href=\"https://www.nexmo.com/wp-content/uploads/2019/09/nexmo-settings.jpg\"><img src=\"https://www.nexmo.com/wp-content/uploads/2019/09/nexmo-settings.jpg\" alt=\"nexmo settings\" width=\"1600\" height=\"628\" class=\"alignnone size-full wp-image-30148\" /></a></p>\n<p>The API information will be required when sending SMS messages automatically.</p>\n<p>If we really wanted to, and we shouldn&#8217;t, we could create a cURL statement and hard-code all of our API and phone number information and add it directly into the GitLab CI configuration. We could, but we shouldn&#8217;t. Instead, we should create pipeline environment variables in GitLab.</p>\n<p>In the <strong>CI / CD -> Settings</strong> tab of your GitLab project, expand the <strong>Variables</strong> section.</p>\n<p><a href=\"https://www.nexmo.com/wp-content/uploads/2019/09/gitlab-env-variables.jpeg\"><img src=\"https://www.nexmo.com/wp-content/uploads/2019/09/gitlab-env-variables.jpeg\" alt=\"gitlab-env-variables\" width=\"1600\" height=\"611\" class=\"alignnone size-full wp-image-30149\" /></a><br />\nThis is where you&#8217;re going to want to add your sensitive information so it isn&#8217;t exposed to everyone working on your project. Add the API key and API secret information as well as the destination phone number for the SMS. To protect it from the pipeline log output, make sure these variables are <strong>Masked</strong>, so they don&#8217;t show up.</p>\n<p>Now let&#8217;s revisit the <strong>.gitlab-ci.yml</strong> file. To make it easier to understand, let&#8217;s trim it down a bit and make it look like the following:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd56094d688181564\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nimage: \"alpine:latest\"\n\nstages:\n  - build\n  - notify\n\nbuild:\n  stage: build\n  script: \n    - exit 1\n\nnotify:\n  stage: notify\n  script:\n    - apk add curl\n    - curl -X \"POST\" \"https://rest.nexmo.com/sms/json\" -d \"from=15404161937\" -d \"text=${CI_PROJECT_NAME} ${CI_COMMIT_SHORT_SHA} Failed!\" -d \"to=${to}\" -d \"api_key=${api_key}\" -d \"api_secret=${api_secret}\"\n  when: on_failure\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094d688181564-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094d688181564-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-1\"><span class=\"crayon-v\">image</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"alpine:latest\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-3\"><span class=\"crayon-v\">stages</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">notify</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-7\"><span class=\"crayon-v\">build</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-9\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">exit</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-11\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-12\"><span class=\"crayon-v\">notify</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-13\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">notify</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-14\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">apk </span><span class=\"crayon-e\">add </span><span class=\"crayon-v\">curl</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"POST\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"https://rest.nexmo.com/sms/json\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"from=15404161937\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"text=${CI_PROJECT_NAME} ${CI_COMMIT_SHORT_SHA} Failed!\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"to=${to}\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"api_key=${api_key}\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"api_secret=${api_secret}\"</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094d688181564-17\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">when</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">on</span><span class=\"crayon-sy\">_</span>failure</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094d688181564-18\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p></p>\n<p>Notice we have just two stages, one of which only happens when there is a failure. In the <code>build</code> stage we are forcing a failure for example purposes. This failure triggers the <code>notify</code> stage where the cURL application is downloaded and an HTTP request is made to the Nexmo SMS API.</p>\n<p>In the cURL request, certain variables are used. The <code>${CI_PROJECT_NAME}</code> and <code>${CI_COMMIT_SHORT_SHA}</code> variables are <a href=\"https://docs.gitlab.com/ee/ci/variables/predefined_variables.html\">predefined by GitLab</a>, but the <code>${to}</code>, <code>${api_key}</code>, and <code>${api_secret}</code> variables are what we had defined containing our Nexmo information.</p>\n<p>If you push your Git project, it should send an SMS upon failure and that SMS should include the project that failed as well as the commit that failed.</p>\n<h2>Expanding the Messaging Options with the Nexmo Messages API</h2>\n<p>The Nexmo SMS API is great, but what if you want to reach other platforms beyond simple SMS? This is where the Nexmo Messages API comes into play, which offers SMS, Facebook Messenger, Viber, and WhatsApp support.</p>\n<p>There is a little more setup involved, but you get a lot more features as a result.</p>\n<p>To get started, you&#8217;re going to need some kind of backend service. Since Nexmo supports Node.js, it makes sense to use Node.js and JavaScript to avoid having to manufacture your own HTTP requests.</p>\n<p>Create a new project directory, something that will be hosted outside your GitLab project. Within this directory, execute the following:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd56094f844781201\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nnpm init -y\nnpm install nexmo@beta express --save\ntouch main.js\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094f844781201-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094f844781201-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd56094f844781201-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd56094f844781201-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094f844781201-1\"><span class=\"crayon-e\">npm </span><span class=\"crayon-v\">init</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">y</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094f844781201-2\"><span class=\"crayon-e\">npm </span><span class=\"crayon-e\">install </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">@</span><span class=\"crayon-e\">beta </span><span class=\"crayon-v\">express</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-e\">save</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd56094f844781201-3\"><span class=\"crayon-e\">touch </span><span class=\"crayon-v\">main</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">js</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd56094f844781201-4\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0001 seconds] -->\r\n<p></p>\n<p>The above commands will create a new <strong>package.json</strong> file, a <strong>main.js</strong> file for all of the application logic, and install each of the dependencies.</p>\n<p>The point of this backend is to control webhooks that the Nexmo service will use. When working with the Nexmo Messages API, a <strong>status</strong> webhook and an <strong>inbound</strong> webhook are required as part of the message flow.</p>\n<p>Open the <strong>main.js</strong> file and include the following:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd560950918181287\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nconst Express = require(\"express\");\nconst Nexmo = require('nexmo');\n\nconst server = Express();\n\nserver.use(Express.json());\nserver.use(Express.urlencoded({ extended: false }));\n\nconst nexmo = new Nexmo({\n    apiKey: \"NEXMO_API_KEY\",\n    apiSecret: \"NEXMO_API_SECRET\",\n    applicationId: \"NEXMO_APPLICATION_ID\",\n    privateKey: \"NEXMO_PATH_TO_PRIVATE_KEY\"\n});\n\nserver.post(\"/status\", (request, response, next) =&gt; {\n    console.log(request.body);\n    response.send(request.body);\n});\n\nserver.post(\"/inbound\", (request, response, next) =&gt; {\n    console.log(request.body);\n    response.send(request.body);\n});\n\nserver.listen(\"3000\", () =&gt; {\n    console.log(\"Listening at :3000...\");\n});\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560950918181287-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560950918181287-29\">29</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Express</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"express\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-2\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">require</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'nexmo'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-3\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-4\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">server</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Express</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-5\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-6\"><span class=\"crayon-v\">server</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">use</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Express</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">json</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-7\"><span class=\"crayon-v\">server</span><span class=\"crayon-sy\">.</span><span class=\"crayon-st\">use</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Express</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">urlencoded</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">extended</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">false</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-8\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-9\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Nexmo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">apiKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_API_KEY\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">apiSecret</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_API_SECRET\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">applicationId</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_APPLICATION_ID\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">privateKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_PATH_TO_PRIVATE_KEY\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-14\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-15\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-16\"><span class=\"crayon-v\">server</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">post</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"/status\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">response</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">next</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">response</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-19\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-20\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-21\"><span class=\"crayon-v\">server</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">post</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"/inbound\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">response</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">next</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-22\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-23\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">response</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-24\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-25\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-26\"><span class=\"crayon-v\">server</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">listen</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"3000\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-27\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">console</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"Listening at :3000...\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560950918181287-28\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560950918181287-29\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p></p>\n<p>For now, go ahead and ignore the tokens. We&#8217;ll worry about obtaining those in a moment.</p>\n<p>The above code creates a simple Node.js server with two API endpoints which will represent the necessary webhooks. In our scenario, we&#8217;re only going to print out the requests that flow into the webhooks and bounce it back to the requestor.</p>\n<p>A request coming into the <strong>status</strong> webhook might look like this:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd560951134751596\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\n{\n    message_uuid: 'UUID_STRING',\n    to: { number: 'RECIPIENT_PHONE_NUMBER', type: 'sms' },\n    from: { number: 'SENDER_PHONE_NUMBER', type: 'sms' },\n    timestamp: '2019-09-09T23:18:25.308Z',\n    usage: { price: '0.0062', currency: 'EUR' },\n    status: 'delivered'\n}\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560951134751596-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560951134751596-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560951134751596-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560951134751596-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560951134751596-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560951134751596-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560951134751596-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560951134751596-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560951134751596-9\">9</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd560951134751596-1\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560951134751596-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">message_uuid</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'UUID_STRING'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560951134751596-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">to</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'RECIPIENT_PHONE_NUMBER'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'sms'</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560951134751596-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">from</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'SENDER_PHONE_NUMBER'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'sms'</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560951134751596-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">timestamp</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'2019-09-09T23:18:25.308Z'</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560951134751596-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">usage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">price</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'0.0062'</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">currency</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'EUR'</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560951134751596-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">status</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'delivered'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560951134751596-8\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560951134751596-9\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0002 seconds] -->\r\n<p></p>\n<p>Because we won&#8217;t be receiving messages from users, the <strong>inbound</strong> webhook isn&#8217;t too relevant for us, even though it is required.</p>\n<p>So let&#8217;s jump back into the token information:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd560952890747052\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nconst nexmo = new Nexmo({\n    apiKey: \"NEXMO_API_KEY\",\n    apiSecret: \"NEXMO_API_SECRET\",\n    applicationId: \"NEXMO_APPLICATION_ID\",\n    privateKey: \"NEXMO_PATH_TO_PRIVATE_KEY\"\n});\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560952890747052-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560952890747052-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560952890747052-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560952890747052-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560952890747052-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560952890747052-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560952890747052-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd560952890747052-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Nexmo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560952890747052-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">apiKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_API_KEY\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560952890747052-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">apiSecret</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_API_SECRET\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560952890747052-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">applicationId</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_APPLICATION_ID\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560952890747052-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">privateKey</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"NEXMO_PATH_TO_PRIVATE_KEY\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560952890747052-6\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560952890747052-7\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0002 seconds] -->\r\n<p></p>\n<p>As of now, you should already have the <code>apiKey</code> and <code>apiSecret</code> values from the previous example where the SMS API was used directly with cURL in the event of a failed deployment. What we don&#8217;t have is the <code>applicationId</code> and the <code>privateKey</code> which is actually a file.</p>\n<p>Within the Nexmo Dashboard, click on <strong>Messages and Dispatch</strong> and proceed to creating a new application.</p>\n<p><a href=\"https://www.nexmo.com/wp-content/uploads/2019/09/nexmo-messages-application.png\"><img src=\"https://www.nexmo.com/wp-content/uploads/2019/09/nexmo-messages-application.png\" alt=\"nexmo-messages-application\" width=\"1223\" height=\"754\" class=\"alignnone size-full wp-image-30150\" /></a></p>\n<p>Give the application a name and provide the URL to each of the webhooks that you just created. If you&#8217;re still testing locally, consider using ngrok to tunnel into localhost so that you can continue to test without deploying your application. Choose to generate a new private and public key pair and move the private key that downloads into your Node.js project directory.</p>\n<p>When viewing the applications that you&#8217;ve created in the Nexmo Dashboard, you should have access to the application id of the application that we just created. Provide both the application id and the path to the private key in the <code>nexmo</code> variable that exists in our Node.js project.</p>\n<p>In theory, as long as you&#8217;re serving the webhook application, you have two options for sending messages from GitLab:</p>\n<ol>\n<li>You can create another endpoint that uses the JavaScript SDK to send.</li>\n<li>You can use cURL, but also generate a JWT.</li>\n</ol>\n<p>The easier of the two options is to just add another endpoint to the webhook application, something that GitLab can execute in the event of a failure because the JavaScript SDK handles JWT generation automatically.</p>\n<p>Within the Node.js project, include the following:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd560953501461452\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nserver.post(\"/notify\", (request, response, next) =&gt; {\n    nexmo.channel.send(\n        { type: \"sms\", number: request.body.recipient },\n        { type: \"sms\", number: request.body.sender },\n        {\n            content: {\n                type: \"text\",\n                text: request.body.message\n            }\n        },\n        (error, data) =&gt; {\n            if(error) {\n                return response.status(500).send(error);\n            }\n            response.send(data);\n        },\n        { useBasicAuth: true },\n    );\n});\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560953501461452-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560953501461452-20\">20</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-1\"><span class=\"crayon-v\">server</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">post</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"/notify\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">response</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">next</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-2\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">nexmo</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">channel</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-3\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sms\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">recipient</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-4\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"sms\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">number</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">sender</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-5\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-6\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">content</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-7\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">type</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"text\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-8\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">text</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">request</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">body</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">message</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-9\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-11\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">error</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">data</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-12\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">if</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">error</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-13\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">response</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">status</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">500</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">error</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-14\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-v\">response</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">send</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-17\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">useBasicAuth</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">true</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-18\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560953501461452-19\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560953501461452-20\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0005 seconds] -->\r\n<p></p>\n<p>In the above scenario, the recipient and sender information, as well as message information, is sent with the request. Then the application will send the message and the webhooks will be used in the process.</p>\n<p>If we were to update our GitLab CI configuration, it might look like this:</p>\n<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->\r\n\r\n\t\t<div id=\"crayon-5e9c0bd560954253976100\" class=\"crayon-syntax crayon-theme-nexmo-2018 crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-mouseover\" style=\" margin-top: 24px; margin-bottom: 24px; font-size: 14px !important; line-height: 22px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 14px !important;height: 21px !important; line-height: 21px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"Toggle Line Numbers\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"Toggle Line Wrap\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"Expand Code\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"Copy\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"Open Code In New Window\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 19.6px !important; line-height: 19.6px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 22px !important;\">\nimage: \"alpine:latest\"\n\nstages:\n  - build\n  - notify\n\nbuild:\n  stage: build\n  script: \n    - exit 1\n\nnotify:\n  stage: notify\n  script:\n    - apk add curl\n    - curl -X \"POST\" \"http://HOST/notify\" -H 'content-type: application/json' -d '{ \"sender\": \"15404161937\", \"recipient\": \"${to}\", \"message\": \"${CI_PROJECT_NAME} ${CI_COMMIT_SHORT_SHA} Failed!\" }'\n  when: on_failure\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 14px !important; line-height: 22px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5e9c0bd560954253976100-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5e9c0bd560954253976100-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 14px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-1\"><span class=\"crayon-v\">image</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"alpine:latest\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-2\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-3\"><span class=\"crayon-v\">stages</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-4\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-5\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">notify</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-6\">&nbsp;</div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-7\"><span class=\"crayon-v\">build</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-8\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">build</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-9\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-10\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">exit</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-11\">&nbsp;</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-12\"><span class=\"crayon-v\">notify</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-13\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">stage</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">notify</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-14\"><span class=\"crayon-e\">&nbsp;&nbsp;</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-15\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">apk </span><span class=\"crayon-e\">add </span><span class=\"crayon-v\">curl</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-16\"><span class=\"crayon-h\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"POST\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"http://HOST/notify\"</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">H</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'content-type: application/json'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">d</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'{ \"sender\": \"15404161937\", \"recipient\": \"${to}\", \"message\": \"${CI_PROJECT_NAME} ${CI_COMMIT_SHORT_SHA} Failed!\" }'</span></div><div class=\"crayon-line\" id=\"crayon-5e9c0bd560954253976100-17\"><span class=\"crayon-h\">&nbsp;&nbsp;</span><span class=\"crayon-v\">when</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">on</span><span class=\"crayon-sy\">_</span>failure</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5e9c0bd560954253976100-18\">&nbsp;</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0002 seconds] -->\r\n<p></p>\n<p>In the above configuration, the Node.js application is used and a JSON payload is sent. The information in the payload is the data that was previously added as pipeline variables for the GitLab project.</p>\n<p>Remember, with the Messages API, you can use messaging techniques beyond SMS, even though SMS was the basis of this example.</p>\n<h2>Conclusion</h2>\n<p>You just saw how to include SMS notifications to your continuous integration and continuous deployment pipeline using Nexmo and GitLab. While we didn&#8217;t create a very extravagant project in this tutorial, the concepts that were used could easily be taken to a more complex project. The point here is that you can take your Nexmo information, create environment variables for your pipeline, and set up a failure stage to notify your team with SMS.</p>\n"}